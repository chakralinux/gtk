pkgname=thunderbird-i18n
pkgver=38.3.0
pkgrel=1
pkgdesc="Language pack for Thunderbird"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("thunderbird-kde>=$pkgver")

_languages=(
  'ar     "Arabic"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'br     "Breton"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'es-AR  "Spanish (Argentina)"'
  'es-ES  "Spanish (Spain)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'he     "Hebrew"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'ko     "Korean"'
  'lt     "Lithuanian"'
  'nb-NO  "Norwegian (Bokm√•l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta-LK  "Tamil (Sri Lanka)"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)
md5sums=('7d1e1044ab64083f9a6d27d58f232ad2'
         '6bab6161cfec8d70c43d79fefdd44ac6'
         '5266566107d2cc07273d178f1130ad47'
         'a5d0e23e5d9c3574c2b867b6a0192fc3'
         'bd2f75dc94716054026228b5bccaaf7e'
         '60608fe67ff8101ef8b9954c5254e407'
         '05c3d3830f668abce863d52cf79a700e'
         'e1fabbcf45a9bb3d03a6c00cbfb5d6c4'
         'b8a5d29995566d5857def15b4f173d2d'
         '75393ecacc2a1883d51bfbc3c3bf7636'
         'daa71551e2e75146554e0eccea6ceac4'
         '7e9fe4267b9e1704e281d34e7e2cebba'
         'fff32ffc1c25cc9174c1990b2491cdc2'
         '3bec4ac98abb7247725bf66da0b39110'
         'e978025364a5856084c577b49469e839'
         'ddec47accaad61c4b207972401b27f42'
         'af4e86b47d90ded477044f532cff9ff7'
         'f43330de7cd39c3abac55c6d6cc73715'
         '7337556fe9316ca48119c50f2394db81'
         '8133e153bae59af0533a942906fabdf0'
         '9b8fa5d4be54c508875b8466cc1bef3a'
         'fc92bbba30cd136126ffb1aaa28587b9'
         '40971129b1b55c409fbac12181e9f01a'
         '1d7e2b6fd99f1c9c4908eddecf084a73'
         '0f4666cf53d5bc6d57ef6898a10cfb60'
         '5720c0c91657210f323b55f58083fb34'
         '750c740e965a1afeed75011554ed67b4'
         '0b27533e7e427b357a69f37be13796fe'
         'e87e12250ab7eb0e8cc64b91820f62eb'
         'a24874472edb315c4b619e1d2fa58f30'
         '3b0786e66b70da75a730a5ec33091183'
         '5e5e918c648ded8ab0043a3937c94019'
         'edbf9fd5271e105cb8ad062d1656a429'
         'a80ae77dca99a840c29d261eacf61877'
         'd701138626548dd08745c4153f300a64'
         '6ddbd6d179df6829b84b8d075b515b65'
         'bdf4767c473c6620c78e1efd53c83da4'
         'e0e47b88dcbec8fd8433c9b226e93a39'
         'a65003fec4dce988f07df46c10655aec'
         'b51ae9a73bc9bbc4f169d5d025e97593'
         'f5a15779cb7b06d14d0f2920a6a132aa'
         '3c5f01182ddc35e53213732c64147bba'
         'e45319471979eed8272e760727ab7f94'
         'a3854a3aece8b2633a2c00aace5f7b66'
         '7042e0977d2787a86ab580549d9edcde'
         '6b5b448ac0821ea6739a9b6e37b4006e'
         'fd9f4a321b96687810feeda8a2e017dc'
         'e0717a30c848a6560f5c261dd68d8fcf'
         'db85c1684e4a6f532792365224462246'
         '0a7bdcf354ae43ab219682f9e4c4a7a5'
         'e19b4879a7e7da9d197cfca3ca5cf4ec'
         '9f946e6109c236e38ede8e84f4f38d89'
         'e570badf2846634f1efb18651d6df91f'
         '13b9d3890ab57c96584d046d6d5204a8'
         '5e616b7cc939d6b7be886b4247fbd8bc')

pkgname=('thunderbird-i18n')
source=()
_url=https://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/$pkgver/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=thunderbird-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("thunderbird-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_thunderbird-i18n() {
  pkgdesc="Transition package to split build"
  depends=("thunderbird-kde=${pkgver}" "thunderbird-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Thunderbird"
  provides=("thunderbird-langpack=${pkgver}")
  conflicts=("thunderbird-i18n<31.0")
  install -Dm644 thunderbird-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/thunderbird/extensions/langpack-$1@thunderbird.mozilla.org.xpi"
}
