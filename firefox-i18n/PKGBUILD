pkgname=firefox-i18n
pkgver=36.0.4
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('8d3ffb704281c82a2150af76500e66da2cecdad53917f7e505f877c1457543eb'
            '4b0e7907ca982d83bcf634f0cd744e17c93a54601d1890c2e6ab978c81412f39'
            '593622f3a36c11bbed1fc3b1b962308589c01077d9329331b09b95725a3d3146'
            'abb58125d4df6a2f14f8840014ea8d3857d1ba3b17015641a78eae19a4924dcc'
            'b59cc4e9f5f8045dbad10226b8a63ff1b11359f1a243acfdfe05f28714ec8167'
            'f38d28af7ee041c3c3e427b547091d94ff6b5905dcc30be3aced8c43ac07b64c'
            'fc9529ab857628812721632f281efeb57867c8f3665501aa18734b63a44e615b'
            '698d41b7d3fa63c90d1aac3adc4bd7b15eab7cf1942b43f8e50684b16c9cc76d'
            'a184adf1a237c315b954bd090e53b4411f1602fa814ee60255c2de5452cb9d8a'
            '33dde758a9cdde59ffccf4f66e0683bca4125e4570f1120aa761d42be8089434'
            '7e868d64417847d955e7bbe3fa4c3c6b5488d76f3a11ae1bc16b51ecb94e603d'
            '0ad6f7cfb3c4b162ea7c779f57e54e5671f4e84b655801bfbe9c038b739e712e'
            'd18b9ed0a3d814b8859f85f91f195c30c2885b575c6a7e6b0a8acdfc46892f9c'
            '11919cca8776545106e46a93d76fe70eadfbb723ea20e92b180c88a34c8bbeda'
            '71f19ac7f2c6824ccc312bf453c1534c8eba9f04ea03dd2e143d0f489f1bfd82'
            '0e8b34b29d1a7774b85825b5a472e420629bdd3f53fe6e0ef97b4b02121483a3'
            '47d61723e9692011d66b0eec801577ef93a1849420d790a961f4394dfe760a0f'
            '98ceccc1fe2644e812133ae88ca5cf4c4608d50fecc4a3cc14a3ccac3c0e1562'
            '84cf04440d0ceca1c3cfb9db4586e604ddaf35e4f5bff6b2a02e2443061ad67a'
            '743d6bc20b30695b7860e15af1ae179719b27473ee0761b39b3031d7382dca8c'
            'b44c680815db0b2fff367270de3393f9ed7998d3201832e998beb6ff7375b1b7'
            '3783bf8d3aed17ca3b0e0d4fae10ffb5c220abd63cc7e93c9b4e73064d6966a4'
            'b2b832e53a8b78b8742951f480accea82177f70e395bdf51ea564a4c2109d2a4'
            '52b8031b389f5a756d7bbca8373a342d14e6dad5ef654dc63f916f5047104723'
            '97ab6f9d07efee7578deb58446bac1b9bf8f61584d2de28b01ebd706bf869af6'
            '90c473c74bc35c1008f37a862c6960fd001da12903eccee41b287977a37aedf7'
            '39ccec981404d1a4da076407686ceba3241ce20b3d4fcd9fd7e61a69c821732d'
            'f23eb97a8311dea5cf2edcb27b95be84fb62f074f16c6767bf17e7c94db872a7'
            'e8d086eccd70cebbdffd41f54421f79519b9c258bc4b68c1d928ee1f3679329f'
            '2d94514f33108b1acba4278ac3d3fe723462f2a761a4a80179cca1b7445aaf9f'
            '2581e2880f752ff39618ec80fc9dbcdc6b43712f68a1319993c7616474399f8c'
            '3cd3fd68d4e0ae8977244603ce5bd63946e3f43d38a6fc15827f1d8ff1f478cb'
            'a866f1170811d570a73dfd1036bd28c40555a6e56ef3336d83a78618b261e57e'
            '79d9a2712baef419ad0e31ced9267c052666ca48ce911e68dc975f3da9e6bd65'
            '2b1d370ced8ba5167f217fba8a8f8438af4dd6590a0bf3a35de901bfdbd3f21a'
            '45046751b59dc12db37faa32416b07984caf56225d44ad2b90e80fe38f3ce8be'
            '5783f7a3aff1913170f05d44cf47c37de2586c82cc491347307fb769387412d5'
            '1cbaa9e7867019d7ad87363a68a7bcf43524904ae5856d856c0d5bc6a1ac6a18'
            'dd6fc27bfb1af9ef495171cc1dcef181148fed168924d87d7b2b6084679b58e7'
            '2f0b8d08b08a9fd43606c5d6d49ef392f3d36c230f44e8130274584865b3920b'
            'ad8d4d494e4e674a44121071a86af0f948f70fc749532277501f1e6a4ba559b0'
            '61e7670122868f32a75c7b1be71eebadb79f6c1b2bc03de4f9d9adba9894cabf'
            '8987c705f80164d9c86b56d0c71d158c02ae057cc76be4b902d6277aff6c4754'
            'ad556cd3a2229b379e1e621dfef6657074b60a67be2bd897868c3584c8d81989'
            'db65f70a8f9ec1dbfb4d6ec9fa3ede0a59dac6e9aca4305a14978185ce83b290'
            '8c9bf51a06b37001d5d7601fad9283fada55878256f6aae619f022222a41adfc'
            '67f8fc5eb7a392cef2492c0304bfe97a223683241478b4626f592ca154f7fdd4'
            'd9794b1dce1db79f27e0a7b501c16a8885f41b408e7e1c93391f3d327a5d8f1b'
            'c8cf26e63ab2f45ff4cd1e5923e3163b711dfe5cfae91cca029a8cf2477ef452'
            '7d321a0a4220d30e4663f430d289bada880343f3c6710ece7928be62d78dc166'
            'e19ea213e3fb791cddcc8fd2c4b5ae37f5267a7e9c73fe552b394ed2e75b627c'
            '77607d0602bb81a5f18205aa9d73e1b5404d56d32374e84372497078055b58da'
            'da8d5c042efb228df0f2bf947b1ff3ca6b3093430574951d6a4f2acfb7e06d73'
            '470268ff394579d1ba7a140cdc2713afedd58544222c05acdf431dc3c9fefd14'
            '868576972b2fae9b6940f21634f40bbe7d6a124aff775d55988381a7c91aa7a0'
            'd2899c38e71bbb808dc5b67d97c828ceb92a04dce01a54dee1caa62341eb4fa1'
            '90cb48cdbec83975ac09c99917eb6f245139b0eeacc184bb7d00dc46da261204'
            '50ecba9035c0ead9e50fc5e38b272c258d26790a7cebc89adb5bfaca0175ebdf'
            'e0e248338b4e74979b3aa2111393c322a9d51c0ea1dd87082a5e730c5fd75af8'
            '9e1de265eb7e4cce88f85498f8c591e27a8c2e9cb6d08a111757e2c8a92a655f'
            '4927ba72abc646055985c81db6f192896a534c212386f6d311622cf368d02d35'
            '540247f124f0e046a259e7ceb3369a13ec560afbd3ce9ec3ac70457cf3eb6f61'
            '3d4a5d10d249f91c3ad2d3cafd2576dae6024d1679c77541ef24f14234788979'
            'b628727553acf88a94417ce65e87c7ca597b048ffdb70b7560c92d0d6dd9cdc0'
            'be340d54a3d8ca58a74da80bef4cf98d316d786db596e2d7eed06ecec1654201'
            'ecf5b7cfcb2e6d199c6d4dfe69c46cccf8327f29e4604a56dd092aabe0855070'
            '0921d99cb70d7608b7d6ce90248b8b5513f3d7168bac133e9e957f19f69c104e'
            'c573fcddb1fab13a1cd5ba954fa2797a72875c4e349fcb0115bae78e22f7e425'
            '259e8b056ef9ac0deff6f78105eedd0933c0af09f089589dcf4477aef5896e21'
            '0bc81c7256b4e2bc38da14cbb5133893890be7b01b5bafb2b37ae8f25c75b13f'
            'b9f472b1eaf89233a39f7f52635c332acc723127266291a9457f0c84c07705e0'
            'dc749a86d0db7abcbfb63cf06b3d5e8d29d3101721fdca4f6e954889a8acecc6'
            '744b6f9cea538f16a059f9debbe8aaa731360d1529747c625500520bfc95e293'
            '9ee5c71de6b2610a972c0096f464168dacb081c566c5533b46eb942de6aa4b6a'
            'c8a39fbc5a98b9eedf005edcda8c760ad4f6952532bfccc6b4391f58eaaf4e51'
            '8c95e7bfd6d862fd629214fb09b3eeabf6b341c2098f58a8532e21499c76867a'
            'a50e66f5e57e041f8e5cefd037c3de387d06b85f617f3eed14c2196dd0200781'
            'c6f7429224980dc8ea5c6afb917f61878286dcfbed4aebd6ed243c5e66fcf0cb'
            'd5e3185f3f75f2a69b226a60dc08e765d1de8320d2f3f2d7d45c1a6b8096edb0'
            '8ffc8758ddfcfe5620d375b01a181c08e8d755384cbacae5ed29fa2cf024f363'
            'c77e7834f8a3f4f46b0068e6f96bdebc7d29334c337ee7f4e9fdc8c667a2e0ca'
            '175c218b17e8489bd2666798578f24b14bb0ffaa5a81298597cb2a322636cf3d'
            'e12f2583915a1172f2fcfd0b2f411e7604104f0b61c15a7a9537afa8133f3052'
            '89482e071836d3292e80d8a0613a61cdb348ca7066471aa2740ad2b7678cdc78'
            '75da370358b09eb101119c3ff01e59f67fcbf587e2fb6f24ddd841fa4f83fa4a'
            '1d2efe6f83faf837df65f200e6812ed6590ab53d092091eb6a3fd317984fd3e0'
            '7fc39846d1e1cff9562ad9e506ee20fc8399f10ce787763c0c529e236410816d')

