pkgname=firefox-i18n
pkgver=34.0.5
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
#  'ku     "Kurdish"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokm√•l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
#  'zu     "isiZulu"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('e8353096f14331a59766447397bb378c1ba56c918f08319f843df3cb7a349dd9'
            'a08c2e142f7f1836480e0d3637cd6d1ebcc73814adbe41e9dc4e3c3840b6cfc7'
            'c2a2216058816e863ec14d28fe66ccfeeaa6effa452ea7ae4274bac674f62ef3'
            '9332514b61ad335dc8e248cc99987f0249b5ffcd659eb91298a3d3fd061ffd66'
            '6f497abfd80ba4ffefe34adeb79260dabfe38c1a7b0de1bf018e5be610523503'
            '1808774b453917fce259528f053e7b6ed11441ba0ae5feb888f9daf05341f343'
            'db6a45d87679f1ec4c3e229a867cd4950fb27b62b8602883b9234ec16ef90938'
            '5d6023850c4d6658180beaea8e93317dd3b5c170174c1d5f61ab021baa0b08fb'
            '053c1ae18e9f458f61e3878af8fe44515e968b48cfcf47141fafa54eb9f2ee1e'
            '28a46cd89a1ded5cac44edc39d0fc6e96dfdcc2509e0b80b90333aa701c95d90'
            '1e2ed180e11901f62d8737cf4164ba6bda95a97a7ccf07193dcf2e1c26e3f92b'
            'bd3a51d12989c13b9ef65ca5f0390ff993fd5a1bae7731ef1e3f61bd36b3f9ef'
            'a42cd6bb2a5d6ada372638420447c1527f3f26bd7657c34fa0615554282b2d2d'
            'dffc7860b64e9e553c245d4fb35be39dcfe79994ed38ddc71bcdcf7693af4ddc'
            'cf94c5b2b1bebb5da6df71ed6462a039e94b98a57786f67ce91f615be05fce5b'
            '236ed40ed5169b489ccd7f1b5afa757de4bf6d6837de89d82c15a13a1cfa6b5e'
            '1fab506d9b232b8a93f34e3746b12f695d2e950e047858636f28069291a5e156'
            '0021005b695a67e2817ed542944a2343c80deea531c05982cc1226f1c6824dac'
            '9d8204a21f189ed1a1b053c21fb2a78b538bc5886ad556eb26ad9a34eed76015'
            '6e3df65f799906d9c2161c7c533db289bd9e0dcbe8fbb93388969fb8dadbacaa'
            '35ab79b45cfc15270337020db36d383b23673c96e3da97d001101aa9dcebd4b5'
            'f09464b90388c3f0475ecb7b4b61710822ad9fd1f9ee903614e0810e86499fd3'
            '497d343f5e3f44f71c4d3893aaae94e0f27e4109fe1af6046fdbcb4179ca12b5'
            '7964abfb073386881940dccb401967a406562b76d6389fa5a7b454d016e92edc'
            '8552dbdfe8ff407374a99c6fb85d09079530fd26d0eb66f1b2c808d138d006e2'
            'bbe2e7cb078de2897e6e2d1ed8342c43a812c3730275541d846b0d0e0de0b428'
            '1ea3cb17cdf07ee0d698e4cc0d5ef331bf0ae59dc567b79c72e5a4b18fe53d59'
            '410eab97c3b0d6efbc251d20e88529f4f1a448508311610f63dbf3fcea91596e'
            'c2dff67bb2a28ce51c4abb8daede824db969b3dbedcec543e62317da4acd13a9'
            '0543ea10f740de94f468f492645ced2561b9411d683c045a8eada7e29f704095'
            '5ef58313d50e29b194eca621fe2a16e76ba554c8c8f144c331194db79235d5b6'
            'a668d80adf49676f32779673bb53cd263d9bc4273b538f7bd471893e5df0b324'
            'f21452dd16c54c21ed66b6fce119a4a9a9254b8d5113fcef7840c044f7e700d5'
            '72887aa02aa93d8d28a66a0384f93df9d83ad178e77dd40e8e4f6ff3a5c16331'
            '30d750ed9acc97180b63b25f28eeb416c7ced12ca39c077626bb589c6ab49337'
            '7da11ae679d6c376c0d8da32b11da78dba5e32a007ff244f4927068dd6c8e269'
            '957e510352cbad872e85c39141604b4e2430d1ee7f82171cdd3221f4a028b940'
            'd3d486e32163ca1c5474a2d7385df6df270578844aae867fa774572c70f1e130'
            '136df23e8c30d7b0321c87ad7fc15bfa2ae7457e54bdd76e2ac0cabe2bf24851'
            'c681cacf708a1ba07cba15fb35e17541ce77206098fd9279e89f6bb3390e4acb'
            'c8f88cc61909a569976c1a0ab73ab805cac25babcaa0b6946820ccfc4a034bd6'
            'f2e96512f89922683f6c9e34cb790da3555b9b241f88ac3c0444a05c9a7d5c33'
            '400e2d39f80c03d06b265a0676bb26e03d9080c1b4458c9a1b159710e05905a8'
            '206befa8c3ffabb4be51f4b52d416a571f2ebaae4daa34a2a03100f0fd9eb212'
            'b1ee00a87f9d4eb22875065207e6b5954f1e6f007a4365a10e8e8373d82e7047'
            '98df33c9ba84c2371aa3eb3de15c5d03c296fea74572170cb5f63f3f837fae07'
            '36d1b7409fa996c9edd70fcbbeea4ceb22f9a8b49a362ca562937331c8ab397f'
            '8eab33456b3819e3d78f6c33166bec665126f43f891931b2ea562b9c618528d6'
            '86c3891dc919a43afc42fd43288d4ddddfd755a01c29adcac15613014438d45b'
            '9aaa8a47535f673ff31b2ec8919b6cfa862c74ed38c32bf1a786133505e7200b'
            '26e2f3464b9d3dbf1cea23e0c035c4e2250c1330dcb43659876bbd32c49e98df'
            '1142730c98762f878ca997082f3c070f3c6385672c978194c3276b2859a5c284'
            '8c07d92e5266b72283c477b9f8d8ee1adda3756de9e3bb71adeca7733db55689'
            'bd61a46f92035ccd52b9ae0025333f7cdcdcb1dd075eabf3ef5aaf429bada441'
            '8f3940e9ec2b473370dc4f8526f7c8e310802c06dcdbd75a26f768fdf73784b7'
            '3053eaa65243f7a1bab59b55f260cbb213bfb0e6660b43f7b706330cea76533a'
            'b184ab23f8595fc93616d5a984fcf8b7267d49017520a2a6d5b702df30fec821'
            '440f039580558d35d914d23ea861f154dcaa230edf0c4c90c199fcb6df0c1f5e'
            '09c985363a0304d9c67e081fc7cabe1e95bff0262bd6156e7aa18119e2442c48'
            '4474d102b035c4c167ed4b69314a29065ab72e528448ab472ed9687f91c618f4'
            '7e5d7057669e8dfeb169f45baa77629e0074ac9a1f36d8c579d4389cbcf7b27b'
            '1c4049050d77f03d4059843692883e1a38e9e81f5a1eedfdb40d08bae74458cf'
            '8c5309d922a8388ad6c0aea87a3c66f82fa715a93a313bc71660a9b87bdeb8d0'
            '0848e6243504fe69b519cf53ef935aa4dae88b04a54b5606a87301e234f2be0d'
            '13d66b6e3545dd8a8744315a33139122cf6c51b640092aa432154b70150f8318'
            '0f9c0e2f01e39bd9b6d7a2ebd3a9a8ff52448d965f9c68b0ae8180c140f9354a'
            'ca2432b656b660c229a9951b7c5cc5c38292335627f88cf0f600558ea075bf42'
            '74d04a7997dced04b00e0da0dfb53534a401773f820e4ea2c00876b324728c5e'
            'f72ebe4dcbd4f805dc8a02fb6759173bf0396d5663eebb2eaa5051e7ea17c891'
            '3640c9d11e862f5699ddc395537eecee0636a8fca646885a26b078446c26989c'
            '94d5b219ffd509e896b15fb378c618ce4506cdc510807d42e2bb67bf9a799c83'
            'ad396d932d0e24dac7b3ce1a5148b893fc9b9883e79dad32984800efc99a8cb7'
            '91432ea97508792ada8099044a8e4b60aed979a329b553159c78add81c67cfe3'
            'e8c438af26aabfc13c7a6a5b951c5cb4d4531770c773b421e15e04b29a6346ee'
            '5917dcd124363ddd5ba1e83cc85864486303d34d13352e304caf695a0e810ec6'
            '34e6430c043b12720ca3745061dee56726ad4868cfddfc4a4d7ea07ed589c10b'
            'e5619e05222d58325474ae63120c900ce137a17dc270aaddbddfa16d267fc0c1'
            '1fdbbcad411b55c52b2ea3c160e212c8e7b1726bf90af8e1de63a64149a9b7eb'
            '4d80909bd0ef6489d99a83326bb479799e28f6460dcf1af29bb88eef06bb8371'
            '6c0c4a4f0a9293c5ddacc2d141bb3aaa9385127a05eb06c86d1b1cdb8131bc90'
            'b1ff01fe2cbf740fe16f50ed096aa1b728f9c2a8783e652d110036db505b6a29'
            '8782ce11aaed942213604c030970d6528543a4e2a239789e0b50e3e482a249db'
            '02e94b53c9960d6fbe6b4ed36aa457604063ea1f70073d799f625300ba1e4849'
            '5e105431140eaefa38237c4901e39b379b7eae39f925b1f81f25290287b32d58'
            '25478fd1cc40b018f70103845121b70d00f93a79efc15ae7efce02e02f4369f0'
            '3928a85bc4489a3344e5d1ac1f8c0bbd27531ac2a5da490456e193d341986592'
            '19bd8ab2881503690d551234a765dd6d813df05fb8990cb18004b45b2e15ec92'
            '53a52c076245a7f4d21c2b029871f097192eeec97bc56548c6ad17e582a62103')
