pkgname=firefox-i18n
pkgver=37.0.2
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('926165025374989fbe3e5254e897e2b0be5b773c23ca6e120b4c22ed129df241'
            'a061b1ada0b931f007e28e28842a93c984179146e2a6891e8d300a4a4535a9e7'
            'b963a694d602b9f111958d8d324106c21f33e25ba8db496f0d3cc8a7e4976615'
            'bfd35b70b0e8548a2d3dabead02b8f83648ccfd5599740dbd4a8205189944600'
            'bbb11d7b5de1a5dcbbf3da006dd4436c6bc5a540f3aeae0bbd87aa152f77032c'
            '9e3530cb2633d93e3b9f7aa488a73f30648a6e6420319c68ce2117d817ba232a'
            '85ded44cdc156f34bd491c1a61451e3f453b913eeb92a0c11e0a3c3bc09f4cb8'
            '2dd2c41024a0bf4df450e83cc5e297572bf484d421c8ad4545c93d9862a397f0'
            'd21afef7b7ea44526b3677c990427a63598ac426c8b71796ded38f4794656c01'
            'e79c6a2040a6c1e24a6170924bc58fc10820b6cc64e69e78d433e17e35c3fd65'
            '01569df1c8b0bbab96bfa54f4e7e02f1105a9de01398dd7c41ad45ba76841ca8'
            '1a63a06d117f0fb7c32c3fb8d87490744c7cc80defcb5f35349ffbf1d8a07f5a'
            '0086ed0291bf822bd753e08b8bf0e9031d1f5204208c1d6485bbfcb422823405'
            '22b2d80e46852b48da4149b423047b935b31a711685781e0f7a0c27cb2e913bd'
            '3f3becf0a5cbdab38674961029d9686cc55b737f3ccb13a3943c0313ddfb6c32'
            'd8cb8ea7d26546be96f077b6018f0046b9b13324d9706c7c5bda2b0eb3a19b47'
            '19c65525a5d82236223d423f599e220cb4e7a4437225e197fba59c57e71cc629'
            'c6b70e379fdf84e968cc4840ca1a58f3b26482fc4641a12c1052cf9df8299b37'
            'deb42af93dde91ec8d9e40abd800d484547baf7af00eb52d4890f5749b4f0823'
            'fb7731ee72735129d9d6a467b07f7b6e86da06c67e7901da0e280ee871418df3'
            '21953b4ba0c0355f836ee83e8ba093ca1930a703f88903b2eb7854eb7adb03aa'
            '9f4cb53771b97fd7e3bf3a1eeac1d19125181c46e0ec68db5ecdbac87094e557'
            'cecd05d54e6c4ea2c8eb141c1db01d43434a30ae5637f395f6ba0977e2e67512'
            '92e92e51c17eed1c2cfe3d6a459320c6bcc2289b81371d6e787bb5e48e0e74d3'
            '745cef6fca8caf25ed23039d2911234d68c3d5d18f393774b3cb267193a1c00c'
            'f091f4757ff8d3df791690f3db3ad2181d36e81b4734b0fafb888d87f15ffd18'
            '682bb3d8fbce66b66f6d131cda0f4ef18651b6d210230d811bf6ee8282b078e4'
            '6ebb219f9d26e4546f5c3e705dac018c0556bb6afe317801ab55f7d97184f69c'
            'cc8b574ce654091d6b89c978d9ab5926cfab1f7c32e1b6f39d292126d9dad286'
            'cfefa3d99156bc70e8c6eb413b860e572d0e603ff5900fdfb700818620b7233b'
            '650947a16010b2c5a872f765408ce4286c3eecdc5b161ac7802d4801fedfaf03'
            'dcaea1379f000b539bf1301e14f423b85a6e9a3b98ba286a69cd60fa9ce4a8e6'
            'f02156c2e1afdd73957ff59b975fafe84fc42b46b3ad4d5217eb360469f3f817'
            'e8eced5ff14eaa120cd54187b5b0494512475bb239fdd3d6d4e125f579c8e6f6'
            '08c8472b43964ed72be90670e03d2f75d1eadd0d4f35149a5d36da554113953f'
            '67cf38870b5d2b63b4aa89c2a2b6ecc0f4a78f7d0cd00bd85392ccee7be404ba'
            'a8362bea171956d293f9a64c958db0ccfb2557ac5cae87379fc334d6f70e2a4b'
            '0ca5f70b61c61a08e661eb6d097fbb17d9a580360ff7f485a95fc364ab319387'
            'bac1ddc5994d2a0e8c5319e9f6850e96f804f58001eef260d5c9c2e46e5da25a'
            '340c129287c701a8a8f25b179ff907f6c94cf31691af144fa7d2eb00f751af01'
            '69a12dd245f467357a03c4e2dfa24e86878c80cf46cc8a89236c70a9ab45f4be'
            '049645ef67cd40a371cf549d03243b27ea166a3d9f79dad4703111013bd1a5f3'
            'f31610557f016237c13e884a05fbdd6af22825a501e9cdacf69fefe3da9905e4'
            '2dc2b230fcb13f15fe08ad92cc34265cb8335e9927a163b190dda849acb143ca'
            '0adcf1743b6a0a2720afadf119c178c8d2bab13eb5cef8d858de95b3183cdfd0'
            'd1130535565c824736be58d17adf304a966b24d0597c34f706fc85de671edb6c'
            'df14770bbba07827aa46b5d0a25f4aa7af68e4c92177c55f1635858672d6c729'
            '824f370efaf3c49e47ed8339a6e8022d2148bb374eb79fb8858cb3fb6fe87ce4'
            'ef922e03e7c9f4ae0eec75bb993a57e7b6abb376a082f5cbe4b52e8e1d599810'
            '565a892a15c082f9315c64fec03bf29bdc36581883716532825828e95386e0cc'
            'b96d64f70ac6f311738cd4d50b4bc9a9262fb430933e1cda5d1106ffa556453d'
            'edd96a72223081d2c67b5a47900e1dc6db72181442f11e90504f9f9692a2e193'
            '5125f35214c1d37dc4f9fce128db8f5d1b792809608641ed1174aa8186aec87d'
            '7562c0a7c3a7b7322ebf21ec4174f27523408dc59993f5c7759fb37b9f1b9c62'
            '241637114b2f1af65497ff291ca2be6a09e60f001462986badce8191265c9d7f'
            'c9f5eea71e44b0dec073f1bde56b7896360efbb80d1690ec58b93e612d801dbe'
            'ee9e926fd12298c223819bdd989413a7419ae757c341bf5542e9e6de96bb046e'
            '19c1ce872a0e93d773f60451f86640fe99dc061c13707e970fa3da37fefbca3a'
            '9dfd14fa453fa65cd7093b3dfebc1f43d1e24a404d90f12a19c394bd9c1848b1'
            'f54ad7f57d02192829f9263fa190c8ea9e16e7bd3498ff5ec82c9a65e4652177'
            'ce21a961154b9c1c32fc1830be083cc47f30200e1d1de8ba5a69bada72eba182'
            '968c4fd5ed5d927c724386f3fb7f7a29e5b7101281a74c3a2e22b1f36ce69513'
            'da69bb372767f6bfd673f1419769856c64d2182b17ee31e5cc3121f72e14e3ee'
            'c720e9d9d04a651d6d127b79323ac5df4e62a73e37d3f6777435f41d52fc0ca5'
            'f761da20447fb094181d31a50e76de3894a2876dc66dffa621cff358b8243a56'
            '3c55925065aaf15fc50dc02ea6532e1a9f46f8ed7745f88662ab7ca29b7d1229'
            '9e3e07dcc0f6da59ccdb5d80f733a446f7b8a42973757d43c9fc3a384708f27c'
            '9c38dd094de9ba805ce9917d9614f35ff003a90570c0e6e519f6f783a368a65b'
            '965fd1018db45f5cc59ab5af6f8f0c5e90418110a52abbeae5ca5a51c2244014'
            '01e754cceb421684ef9203fd9b39b4c6e2506a03a96c1539a4ffbdaa5ef28763'
            '25d494b2c11c5227d5f37c068eea29e4c406e1028e9117edcd83c9bfc6cc87b4'
            '4465babf3c7ec4acacb998e6db9345293c88d59641509b741e934fd859f91098'
            '0fa3343cd2da8924c1535e76ba8d85095ca915f44f2f5cd4a3457e24cba00397'
            '9f92456b5a132f2202266e8513012f41bd23e3147ed5651cfbb786907db383d4'
            'efe66ec46c23db8dd6bf3839e019a24965247c340766052fee9e1b7c5a85ae7f'
            '77ee8cf44253cf0b3644079419132bd2f474476604a4872aca193177786a50b0'
            'b773753103ec8bbca59a6bae2bcd7ab2e52f9af634b6297a142f4c63429a95b9'
            'ec23b99ecd39d0a71303d1b6524881131943c7f1c63becf4b58c03a66cc75403'
            'f2ac3577681a35c741e5aa20de3e7f8510eb49898e645fb53c7a21a21561cef1'
            '41a8f6c0491505f6d94a9138b3fd19d0b1e4ccbc0075fc06f2e73867d1e861d6'
            '642990c4681d0dfb02354dde249425351261d0179e2d06c8e3b6eb6d205f7ebf'
            'b219555f0d631ca183f9ef7eb8e529700f650c0a2eed3773bf2fc7db28f68750'
            '941de0935b605c0598a6cc61c07951e8dc56fd5a27671f38c96ac65fd383828b'
            'e53fa1eaca1be219effbcbdbd4ebb5158fba15c8ba2bc6bb568863e9ad2bdf85'
            '5c9cb771e67ca30086d0c02112c37646f0e03e6e1c78a55885f0a7cd990558da'
            '3cfcb3adc0fc271b2b561897951c2c9ac473602cc5e715b8125cd469126d5836'
            '8e6af6a6ba081e6c9f19e32af6b78d0430c96fc9548e3ac84b6a3e8c23ff8e73')

