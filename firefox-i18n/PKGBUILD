pkgname=firefox-i18n
pkgver=38.0.5
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('0cb86bf4150a73097cb4e93148531672d9496bd2f6e68a5faf2b5115f12e1816'
            '17f7984994f515034b8c5a4803284027808377aa823602cfacc07fd539c369ff'
            'e0dd4e4ef2fb05090908814359292c64117df81a4cc148db180473d46a7a3cb0'
            '8155a44340d05ff25ea6e490a66a3be90cd58422161eab01e351f4e4481bb0d8'
            '26302e9a9a46e77be68f36ad1a0dd2cad397929d515f9127eb99a6546753d1dc'
            'b3e12a73aedf694a821cfc528acb257b79f4b6eb7f229969f3f71430c18a828d'
            'bafcb2fa3711dc4384fa6d28e91e52044ab64403e75332665d782a3b4cf185fd'
            '2bd6c8da8d1486e1d41d009c1c1c3dbeff6727a5d25bd1c3f2a9a6a1196b0069'
            '5c20b0464917a7d15630c77233faa0af17849af5d17d0014344469c38de33a14'
            '7c80877c0b04040df5e1465e7979741579c97c92aa4f2eb38e1f6f41b5aea2d0'
            '9ee27fc8c72c39409ef3b598534d12504b1cecfb1c2785129bf08e48f67b5e18'
            'a63759f6b7066715f98ed90b0900253312b9d832a08df152c0ec608e90227a04'
            '7d16806547945a18530d6310bcc4aeb9641b728320bce5e7ba954cdcd0068257'
            '43b2c9800c1b9fcc2e0d45013c107f0aa76672f9dd02cf52de7e4abd59a8be13'
            '4c10ffacb830e2cc8208d12b2c10886e712acfa5032ff4c2abc7ecf7bbf88604'
            'b07188292e43cf8afcf8ab01066d1793c42d6ed72a25e8aa2d63d14fa543a699'
            'fbca6602dcc271af7dd8d50929e1175038e807dc0bc3ae08d6b23ea6a2c690e2'
            '3d69094bbcf51935b33d941c5362be5ca5e62703ca7392aa435f40ceb6b8a0f8'
            '4ad01891954c03f03051e8a49c4e820e5bdf0687f2013ec74851a5f58cf0949d'
            '95661df821b99a3e408d21c4e7668f0e80245c329653ec230409af428b8d4aeb'
            'd73ffa6a95f2ca53dfbd5f31617018c492acd6d3ffad670b4c03dedb2f02867f'
            '9c9394cdeda4b243359e2a42e4aa07513ea8d3f8ebea5cc72f32c4362a3578fc'
            'da6205eacb747871438e43f9183e96c0b21914c46bbd4b51fb1aa0e0cc249330'
            'b0aa2793de64b1621d574c35f428792893e09a7ba23070544697083c96c3fc3f'
            '89bcd222356181b7c6ec726e65cc45e3e5d94263d9026ec865e377b9878ff143'
            'f3f41fb118f71627adb90335ef72bb672d3880b7cdbd655b43e12c66a2aeb384'
            '99094d3f34a3b6cc361c724365d34f28345a75fb546d8ae5c8bcb5b639c4242e'
            '91f4499d9a9931ebc38f0ac4b23a67ca0629e9137717549d737e94b09cd413bf'
            '704e20686853320e81367f3ba7f1bc991aacf932b2d025f0468c80b31c2b18b0'
            'f7efa1355e9ca1cab53c7998a89dca5c6b6e729a4c789872885c5ca1a564c85a'
            'c2b29e5196edc243f4e0b9a511475a275ef4c3302306531d92221ba371ae1923'
            '8617dd61bc0d8bb33e9100586ad10033da2e927b28cea07e6bfb79cf761dc30c'
            '2d8111a601cccab03cd4d50b74c1e8fdd306eb46a7816c99f95ab09d62acb74a'
            'c6d23077572290865ed0a5b2522404f51d7b2b0d3e92b23d6a559558443edf40'
            '2ad0fcdafc68127a247b7e04a9107d72b975563318f17647e6f4cbfca229373c'
            '1b1564eed11b5d3b58862e7e03ec63b3a6f91e3dd989c907f5e6a9cac9741479'
            '1b51590e36f2fa0849cc96bc0b65d746a9524a637567b8149600270667454e20'
            '9e0c607764d37b41a736205d60e9c87931ec89706b1e55297a115bd99a4a0d9c'
            'b6db051b03dc444bc6bc0be9b90281a1c454be8faaf5c42be8a1319fd378e3cf'
            'e46704198e8c64fe6917f775eeec6ce564da049e7ea5717c426c61981c507957'
            'caedafede47792d24110a180d7e22ac9538af2638f22ee87788dec4c6b03b778'
            'd11510afc172fbaae46e2823af8c92eaec520b5fb74c08aa278aa1d00a843a35'
            '899cdace305a55e15cac2e74e7b9a58e7fcf871e3b4de2b6a4a3ff782bc044e0'
            'c286cc1c83d42dabd000fd8f7d446f1438883aacabbe28dd091355c41efbdd82'
            '63e98cec15230d6f310e2d4821c70440173c8c799fa1be2c251685729e09b230'
            'b33d7ac3219285b3e624d1fc9cd880ca8b8ca994ab7542b8f6dc1d8cf75d079d'
            '253f02cd2f4d5b51091ad42e80ce78dba43a1f64a0366ae861800e1284288a05'
            '6374acefe06963e79feec8f025ddb74abf4e19352256c23ad9dd1776ca57a9a6'
            'fe6702edbedd02537c14edc38b71499bbcab0475276d406f5fee25a6763355e2'
            'b88f5a80217688b7ef58ed40c929b977eb2220da96d146d770eb6c703b07cef3'
            '247b57c7f5a70155c952912a70a03a08737180c9a50bf7e174676f4b5d5f258e'
            'b44231684ab045b8b0b52af9a62542bc36440bb155ca6c75271b725acb399991'
            'fcc24a9fa3b382ab50f7bb3dcf0916fdc0ee5bd9ce44251a2050c47f63ce9280'
            '1231de3f5f9218ddda91a2812cb1d75038bdfb4fb03cf930fde31d7b1ba9fb4f'
            '2329e334e3ec437e8a54913d4b7a815e49a14f9e00d8ba92e253137bae541a6d'
            'fd3bdf163f7968148bfc77774fdd1890f938ee26544a2f500e5ec3492ecd87cf'
            'f28f53a4bc4b2f3ecd722ff7da3cf8fda4a2fbd3077ea241a8f642e162aad51f'
            '5a90ca89592db6647df1534097073ff05b7a3f93eb9712687bff106108381b0f'
            '2db84efd67fddece7cc4140234322492558ab3e47add2f2d7425afb15a8546d4'
            '51fb44c1f67a1277e9b6ee3b8acb1467d4ed7d92ce05cac88e3895765a351da9'
            '1deefc6e47fc71d290df56cbaa0b1c9635455b841a189c571ecc19cc70bcfe53'
            '513484c79e1c00ab25bcd821df8cc5375f27e8be370925557ba4302fc8272551'
            '1b90602e4b4a2e35e252cfce1b90025beaa30881cb887812dd2a5afd3f1e4ea7'
            '2a732a2b2a2c682f4d53aa062a60ce2f92972d5c5ea4c69aaee9488bc5d50c53'
            'c07f96ddd4ad647b2d09a40432fed1b6a83d27150f068737a462ebc7fc8fa05e'
            '85debc125e92eab6467da43e1c88f15e62853c543b3aa73ecb0eaa5390b3bd9e'
            '5ab8a4e30eec342dd3a31535273b8abda38d811b42211f52edff2883406f95df'
            '10c8da89f01e49ba8439a36846bb9d15491c01784acaf04de96ca8fcb03fc916'
            'efce3ec47340f20e7324cedd55ff4df4923e98e3b623caf76bf57889c06b0b1d'
            'd3bb9580f894779b713d8edbd53e1a738fc27ca5990762d3fa5832272dc94eb6'
            '9fc7973314b2d45044c005956abd900bc7be98944cfd48046a4680f204b88eec'
            '00251b39aea2e36d82421b08d63f123361f34e0377ffe0bfbbe4b095a2994585'
            '64f7e449e77d36cabc62507c50e435a71ac5418a66d155657c39d3d2cc12d68b'
            '1643a900e010800a877be062ce87979294ad4acce14d5e9f2cf1789906135014'
            '54a717683e7c726a49c7f9b9a8ca5ffbbd4529c57f6c2b1447239136cea93cf8'
            'd0267c9f052bafe94c6db2b9d9d1a85a44df7c037e1daab232c4a31f68e1df21'
            '247d98ba73ea46c0fbb272effd3fb39f730ce619d560d9830df03201ea0874af'
            '9e2417a593fac68cfcad413ad988ad00d97e88c528fc2d8a451ed15be57eb9ad'
            '97591886e34eeb87c026058ed8b5301fab97d5077a301cfc3905457c83aa2195'
            '20048dad2e1057fa84d76c2ba9853ac8e6e591ec662ba304407e42baa2181355'
            '75dc7d3758a90745a8f17cfbfacf3c2322443808827139100369cd001287fcae'
            'ef1ba02d7dc38086c92168fb1f03cccb7389d86b681408eda206724cc1d824b1'
            '75e9d60d647824d845c3e489e733aa42e2aaa78ab3142f4d9e6d5fd690278210'
            '1321b3d5ebfa3d41707bb4f0c02e6a476caa0b2bbd08bb7a8ff1ca825dfc2c99'
            'da592ac753f96dd8e7cfbf9571fbde2bcc5e1ad5af57873b86b136e4e14b802a'
            '6aaecea4904679bdc66139f9019298eef58da591198cb57a1d274424a32cc9f8'
            'abd3ab8c84da88aabbec1617b24b5447ba04b6e8595c024ee3a26f0df20562ad')

