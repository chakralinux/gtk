pkgname=firefox-i18n
pkgver=37.0.1
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('03fa6da27554d536502d480b20d897942f51f776325b149b41658cef8a102e4d'
            'c0a19104aaaedc1baac5a369fdd4a7b2e9e58928b83af44618543c9b7980048e'
            '77828f20f56d5538c0868c5e9d308384bae38080daf8ee6f46738a5767d6ffde'
            '4d08a56db06351e216f8744ad5a153e71154e113aae5cde93691755e7f4a6fa5'
            '191df1743e6ca6c3a3731001d4802c5e3b7625c941c5b9c8ea0b4324e18c4cc8'
            '540ace9be30b9139cbc0b09ff2ddd400e149238eac802b086f3bc0933ada0b35'
            '1dbfb01a62d530d7acc00de3170ec1ca4584fb191ef749c70ce09cb3f02ac854'
            '9ad24be005eca8285fb06ab9383afe8540aef84e866e93f41e68a059df153c19'
            'e972d1c123464390d7dc0aba56fca6ee2010e4a20edad8b8dca67d17cbead336'
            'b27faf8a464c5c338e4c7d49921a9d52db0298a53ba83edd8e4f76a327bd254c'
            'fac287685998690a194ac961c566e553f58ec4eee2b7910ad6db546576b0ce58'
            'f59f80abd720db6cc209bdd052c96f433290c89266476764de42679be5b62aa3'
            '717e62a81f4a496ec94ee4889feebb58f3f6239d7af79b90908c0b1bd3f1802d'
            '361ffde1968c69d7f748bb270a60029e8837031e7682ee9c3d29b2058a8dedb4'
            '516b23d3220a48da66ac4a49d1e0cbcc94270a013082a880731efdf3696c3394'
            'd9a432ad4c4ff6b7315e349803354b2cf2fd212d267f8aa16644e350cb8be736'
            '1234a5638619655ca9f621405f0f8c2596667332127d82ba990ae1e2f1e24edb'
            '2f5a4249f2250a7eb830107eb50cf1545aff00efd82294ba59a385b05a8baea9'
            'db937a3120f55511d4479a8097549e1bde674334474ea4744cd91bdf7512c382'
            '3024aa3c63bc8415a4f4f03a4f30901a97ac36521afe419649bed6f98403c230'
            '68c03a64c2eecd83633492e7bb0d49a5b6e48121d6e918799db2e2c02d5ff2c8'
            '6062f52042be5ac9f52ae1f6abb02a9033bf6e26a37e07ea908f750e929cbf32'
            'daacc98a546f7b9e357476d827878770144315d8584b08f757975284f8b4fe4a'
            '236e850aaa11601255b4f1f258cb5235f4d1fe0c61670441b675a751081932d9'
            '4ce9b0a421ca50f456bb9f8bec7ad6f79ec79a2b53d83f7344e436ec500d1330'
            '5691837814b160d8dbd97a659c48bc68336e50a36834422a12abdb77f4478b23'
            '6d83cdcb52c703a1c56160ce768dd54035add92d16382002d94c6cc393a9ce57'
            'fe05c10143c633adb1e9825aa44e569a124df7686fcd547eb23b7a28bef04c40'
            '8f47ec492639ded1264c74044f9715ee1a736281c980e8e7dcd43dd2e2f944ad'
            '80ec126e622b491a491f72f218d6094e68dfc5cb8d8162912c90d249ac48afbe'
            'f782c1c2866fae138f216e33026d0a375a15f29178ed09d84ef409a6f57c79bd'
            '3a50302cdfd5a896c3d1f55b4152840aca3b784d4af8eeb1cfea67ef1796cb67'
            '4d75d9a4ddfc03dc1cafd698c4dda41ae8465514d41c1a619744800f9fd55dae'
            '18209e71cf968a66d2fd15adc29687843d9d718db282837acfd63b5d72ec66e1'
            'fc14ac0f3a3cb5d56aa50cd64264375b9e5878129ffb8523169feb8a79063101'
            '78c5c30b0382c1633d8db9baf93a04e85e0ae5f9961c0906f378a0812a09c0f0'
            '231956daa151bc95f8357dd3e6483241f6a01e1e8129d906dde35fafc37255e5'
            '25e1a9d0da669e01421662ba50b29bb3b64063e85af3710f43a985faf877f0a6'
            'faaecb3cf7810594fb91bfc889f292081cce8f0961101779143f75b7c5ce455c'
            '3743e98e1c460aa737bbe4a39978452cdb457fcb720e3f622265493e957afe29'
            '451faf09baebddce498e779e6ea84424d09c7a97fd5e466a36fa7f634d901be7'
            '1510d3f43eaae8162fb897ba15ce7da128909193ef0dd445abe13e5c9778f573'
            'f10c829a26d81b1b760ce052db7844708b56f3ff2a6ee89727d29b11bc578918'
            '939b1021f0a2dd4acadb1b027c04c37de7de5f0338d63b8ba7d11aa17add27aa'
            'cc7b7007c1886686073be83be7c1ef2d9acadeddc3d247c768f9e50347a5bf45'
            '725c9428625591daed08fce71e77245efe307c72782ac9d6a8e6c1159eae5e27'
            '37625392a50f28e66834428ac69684506e5f899557c70cd7399f781f5fcc334c'
            '06e051942b5d45b6990274cea44077f959ee561088c0d7a673cd1c73a81ee8c2'
            '30ca7d46775dbc87e3883daf4e7a366d270a9507e74d7a549e6510794b07fe27'
            '3bfd343162000414aa54c7db6582b43b9f5423bb91efad817b90caa5e8736302'
            'd9bb2ef9872a59bf45404b7f68479843fb2be3724116935170cbc313b2cafebe'
            '06abf206ffb239ffda4e85b5947c57b6ef42f51328c8e13611d8b3dae742ec23'
            'bf6939a535a8c0adce612288e1dc004a67e229a66b6666f83c7b058cc405feb5'
            '60c9bc84845980b192a5bed01a8e0ab6d756e14bbc9185b9807f67bb97f49104'
            '93e2f024d61757e852854bd7b4f5798780be64758b0366a619ed7df08f64a1b7'
            '075b05f00c7464fc18a938102fdc59101fe6659d0fc905ec97a525d7be93a0d4'
            'eac818107b962d8963667e2dd1953e5cf5f7615d502278595771def6f7b6e347'
            '168129c47b288af1f8770ed2be6c5d8533e23d14a6283c945a9a52bca9246644'
            '0332f143a9045064371b4391a90aa55788c5491a3ff003d4bf9c98ae36489d95'
            '70ddb68513faedc3e6653322c26d7d48eaa3b3d35c372f87d40d4dcfccf85ce6'
            'af1fc82fba77e0e3f10ebc1ec46b29465f5541b2f171d0a0423a84e2e8a7fdac'
            '8c3bf4a37c71194ef045a61cb32497c5a42834ecbc777bc868fab061a6ed4d3c'
            '19a07799490e74e5b1071dc5dbfcb708e91eae397770875e5412af48d20c5aa4'
            '38634c5c6245d1205cedbecca8080838fa0be514daef14b7b9492001e98f92a1'
            'af781084738bfd306fc7aaf923bd6f691fd58c34b34da2bef57ed7ee29181bbc'
            'ddd41f7b56f175510854ef5f1e1596b2508f28e71582aef8992b0a3f195638b5'
            '0b530041432a956457e8419ddacc255deaae0d5b32e0153b4f2c415ac3fb5873'
            'fa7dd7ec447b0ba95c75a3bdcff49e1d43de472926c148fcd05ea93c88787a8b'
            'eea0f0dd8ee05bae838775080fc964ca2931ca1e7e8f82825f43b3bff2b8896b'
            '819bc2f7ebeef828cd5c356d46f5c4264f6a593c1ca0e42bb70c5b79236812b7'
            'bddcf8e28f62b1bd29d205da43faab8acc9f259ff737ec3d56652c9d35cb90c0'
            '1b1297777068d2ba333d80c9c49f1edc2c891292fb932934cec8d5de16500b6d'
            'bc21a0676cce367d70c935929e0ba2f041e44bb5f60006f842fb4e219f2e1174'
            'faf4d654352eefd26b0ec15d12debbaba4ae0856906adfeee9924efec927095e'
            '3c22ab4fea54afe3eadefcff7824ad3eff2dc1ff6c84f2400d2ecf21e0bca9eb'
            '5324e078f9773a48b1368b5356184257a3551d37aad93510fd7739d10898c6e7'
            '981287f8784d8f4eb248740f55292d3a5ea50bd7d94ac1f09ca78de07cfe07c3'
            '73944f93fa23caf45df0ce34c20a366510625d9f85a2301a52c66816f8041c64'
            '39c8cccd089914aa1cd4b4faa8c469a7423e4a34a0b549ea1cf514c24657df5c'
            '5d313f32305caa922ad34d81a7efaa932974c5392b85aebf8498151e3c8b2613'
            '8e23e022f8f041790e3eaf818fcd3b1a108d76b73d7c3962b2716c25c5688042'
            '97189409f0030a71a15d9a311ffc59a0ff7dbf56cf90ac27eb03c1ac21a26617'
            '95292d34ed9c57082cd5f10ce504afaa70e1453426902fd6ebd0929c41271f87'
            'cc1fc00d160153f9ffda752aa08826b973240f1040397b55a5367637f88df785'
            '99501aa22bcbd83a745f381d07b4ee3bf49e64da8215abbc1ef320ac8b80d490'
            '641f352743c2ffb5a88932aa6b1c9e23281695afd8e8aa09806a120707ee822a'
            'f92466f1afe2a2a718ff8f116946085d527d8733427a2a31507223371e858537')

