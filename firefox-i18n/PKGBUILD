pkgname=firefox-i18n
pkgver=36.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
#  'ku     "Kurdish"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
#  'zu     "isiZulu"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('ccdb2fa8b05d4041c1335e475e09ea127297c0d1c06203f4b5ad83b2d17eeb6d'
            '67ac00aadeba6cb967dc3a411d709a79a922c27b169da7773243c378d9094302'
            '9cd1029602d25f1846927bf123b1e22a7d7ad8adfb1e1d37720e04ef83956b28'
            '922f644b7aac9a132d4fe9ed5d0a5c95402b1c93e89ba77f77fa7d49f27fdb2e'
            '269d718077d9b3b8a91cb8cd39e1e9a8b7e4a1d3ef71594911b03e139284b6c2'
            '0ac5b264d97605c8296cfe5075c3be386475d40a1a6e60b098e850c23fb55547'
            '3d8df88ffecd9d7578c875fd2aa4ffadce151f729b6a1ba1827cfed1589b1d38'
            '4f77b1895188e3f69beaf1ddedebf49d8878cac9c34180daa9f1f98805ffa112'
            '91f7cb0ff11bf436f61faa60abdd9bb370cd1c5e43c14e89a2c03ea5a7120816'
            '43ecf4de57449ed5d6a81f257d59c1bd3d098d4047325f2440ec843db16a8137'
            'a25ed04afe4bd19eeb5e981759e8a7f4aa3ab18f2c37ef49eb293b695b1fa83e'
            '195034ccfba945eab6c11f4b4da9a346a00a56504eeec4606252a30a6473b781'
            'f89fe9044ffdb794376478dba96f23b3ea5c7cc39baf391b7929e78d9598b022'
            '0125f22d5255149117e42949a907fe8897f39c5536673cf33c7cc1e03b5869d3'
            'afb30fff9e349742cd0b41fd6232d84ee56db6b2dc4c8c2cbb188d6787516fc0'
            '1598abfa8ac0da7b6c1efa378bcae668a7842c058da967d3a0fbe2426d53d28d'
            'ae2a29cb72f0360e55ffc24c11909b9a0098239f352030ccb91a65e4067d6e66'
            'c8b3e9c7291645831b9cc738690e934862bf3eafe0068fd4aedbab6db90b02ee'
            'a3d58028627989ad0f006cc564b6dc96faabef2cfbca135a42af9e1c162850d3'
            'ca70005e95d675215f92d6edeb7941376df495c3e8697bfb705ddbeecb554f3b'
            '98c4924bbae9e41107cf5248532ca8720abe51e7116d887c151a7022d1fe7214'
            '672dcedd491cae95a10ca0c861d2736fbe65d906c455bd29f3e13cc4beb2084b'
            '5daba0a8b90e302101b7a0ddd726c346dc257dbf082ab2a55e4c0fa49e530929'
            '7c68b1a590d78a8debdc0e323cbacf93ab9593f16c3ba0fd6ad7e4fdebb3b640'
            '9827ef37e8a7107faba5ed9a59242422fbbe6fdd011625b857dd850b5fd50024'
            '9e499ed6e6d97e946fe7202876ae9ede36870fb9cbe983c47fe26c442ea1c88a'
            'ead713fd99984f77b100f182ff362f0463c78287c0a6a4f7f6a452af32129566'
            '94f09313562ae41c6e24610a22caac098f63ba024cde8f9a9fb630ea7ff255dd'
            'e6f9f208db3909efc51084de33ae1533290eb42afbbb4f21682936567b494486'
            'af01e3f2c03a12eae02b63fcf9cd694875d9039703dd46168305d3aad9e1413f'
            '68417c3d9624a531984e2398acd8ef480f137ccbf2697c5ea4fe1c3262c970c8'
            '96e2e9686e288b3fc8c5c5985e1650d47f5ebd5eb70fbe45859f7cb76a69fbdd'
            '58fde8925ad5eb970035939b99c605a78e96b860c3cb3211807802ce0feb0f75'
            'ff72dfa498df3d6f593c60b74328201faaf04245502fa9bd6f767a47d38a2ca5'
            'ce9a81922adc55c9335bbdd2a2981035835f9f4ecb473a9984fc3f561702afe0'
            'c0ae8c08ae9154a2a18b7374049b3e9f7e91f5ff1f8f00d6d53e0fd24a9eb7ba'
            '06045b9605c210e8d853b6975a3435f20f0225357b6c078ec18a674816908fc3'
            '7eb0c3206389091809e872a9da8bbb43332a5df2353c877589db1fd663f6929c'
            '62830df08619d635df17b21b59954dd3249b8a4422ad2e6f84133647d538e97e'
            '43c2f260530ae0b69bdd621d3d83c015a8d1b0c0b1d60232f0b8e78d90c3c2f2'
            '9818e5a47ce0f21642a399bbe76e9f6b8c1c52757bd84ed78bbd7b785ce61fef'
            'd8538de3d3c2672b117a39bdd6384afd12347d3d9461b494bc2b6f175e8dd696'
            'b06db0dc20ebb9ca89fa7093f3813c81f9b45b0f1b0b8040eee4dbcfa8b2e71c'
            'ffac942337ca53afb88f1730beb284aa3023b70bb8d95b56c8a6947bca40f20b'
            'c4c994fe8d86469209e94c1018d2c76e76baab472aaa11c8593b46c159b55708'
            '42d1879e48898dfbc2b86c30caf90b6dec03c3364b2cde5d45a0f8545b622d26'
            '3ce2574ba5e2f44b51d5103a5fbb67169fc2c8bf9f0872c8a29317be8f29f321'
            '87f7f78509cbd87ca1ed8330493bd60b409bbd779c578f12cd3d3a8bd7e1dd4e'
            '716c92a39d1d750b9125f7e781926320ac2092f3ad76be509881225c04a3282d'
            'a8382c1148f2b9deed045f710131ca1fb35f12727fbb358eaf197d8e3ddb0b9c'
            '4d2afdfe1707520577e55a1dbbb46632050b6594d1f8948d7b586f159f42bb16'
            'e05c051157514150418d530a53240ec3efa757d813db355ba86f1ce77d369cc9'
            '0ed89b99fcf90aa4e55c3cd62507fd1acef4574627f479672d2073643da6b6d6'
            '7327c6d6e6f4b54ebcdaa42f0d6eec95baa89daf67c3b7327564bf227da7935d'
            '30a2ab3d32d57c20b8e111b22f1da8e32d6a940a9c967af27850bd28ead4de5f'
            '767b745a1a172a50b02f3feb0ca5ea80c98408495114294cb7059dbb4672cf6b'
            '9ca6a1e7dc50d3d53ac3d984da143dd91cd45d146875370310ff1d714263905d'
            '4a4510751c304f314bea90c031611e87405b0f3271814238b9937326617f54ef'
            'a3607568927c3657fd812293b6f8acb3fc5e4c21ef4f198d2d86a4ac518db7cb'
            'afb3ef3df3d609f9f8f63c44fe0861351cb5ac6c836a6d583f17ba4097272d9a'
            '8879f8b69b70afa98124fd6638ae1e9d9c7a57fdfb339d0d2fcbb312b0bbcd9e'
            '7c6592ac9f1de0f7c47e227f4dc52940f5c301b850a2c90227e6b4128d06bf72'
            'b107fc9402a587288f4648e8d99340568ec0f5884f57b8fe723ba2d64d653ef6'
            '476d95034050c72b796df1eba06edfb059de5ddc1e2e505bcf60b881be95f8c1'
            '9dc6e56fb5431a8c7fd60addc89507fb93a42ab8376853378a770a1fc0faaeb6'
            '939a1ebb4b91bf80dd56db5b0c7b51d024e81bcd466fe415c2b10aba725991f9'
            '3ad359f45012cadeacb42f2287cb980d2fa2c2cb2378be46993a88fe3edd85c8'
            '16f5cdeef111fc217dec9923edc348d87018d11333d6d6aa37610d7499849518'
            'cbaabd468e7fa8474285a490692a0712e4f7565e88274522bd0f7e22425199e9'
            'c3d0c49d26e07268eea08936a7e1839c199bfabf33e37a754794db689f4fdab4'
            '51484a345fadc481c71874f81b08d77b65a5e79de4ca8963a1faad8c6eb1ff33'
            'ac9f0384263bd16cbacef2678b90ba4e25a8aa85e07d1d12bf8979abd84494fd'
            '30cfffe0294be9ab499adde23c0c0ba492b33f2ca2e84bb793f7862671509ea2'
            '5a83c17f2cfa820bff38da04c71e15c9ab887b2776a1312d3a43821f887ee4af'
            '24040b2649c1f0e10fccd951d3018ef8705413d87289f2ddf34993c2dd4251a6'
            '7419935899cf0b8a9746766d1d80a8205aa9961da34f5b1f71860e1d4b6fcd66'
            'b330b9fe46ecfeb684bb415a4ea1e35c2618c2561e1aa766057dac65cfc8a572'
            'a0bc3fa9cbc407481057d705fb700e7946859868e196a55075210c0a40b32afa'
            '824a45469acb01f496ba4be5412639f2dfd43569ca8927222801064636ba491e'
            '74134d6358cfd853fe2ad894ec1064f9ac557eb10406ed6f63169b158f7d8019'
            '4cec0281873cca7405f2dd2fbeeb1469ca22309415cdcf11d741f560835b3237'
            'f67a2b4c4dfcbc68b796ecbed7849181bc957eb561b5229b04c091acbbc1db13'
            '09953b61271efe486a5e9827c2de39aa3b55940ae2ef886c5e5129c0bd6e0318'
            '86b32cfc3ac3c38fe3f51b0391f89d5e71061fc3248f0db05a87d9bd566d917b'
            'b31cb3c97096297e2e9218492aebc8ee6979b0329c758c4d65139d48c94c782c'
            '94ab7f7953531a1e9714870b763d8e42d5ae6346e3cc938c59ce45dc27fdca84'
            '7d3d81cff82c13ce2b60d779dd7a1a26688176420c1608b4847cb8aca915ddcf')

