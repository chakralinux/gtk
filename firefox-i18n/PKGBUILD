pkgname=firefox-i18n
pkgver=43.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=https://download-installer.cdn.mozilla.net/pub/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

sha256sums=('00819fdac4c16c4a576ee23dd775860dffcca209276f3c4b33e47677a6a056fc'
            '401e414b03e2ec7e09420c0ef06c9c60bc2a7a3193903e5a2d1ccc24564ca85d'
            '24d96e39aeb2cdac72a09f385e05deba12a6ab7d231ad2024ff0e2cda8b85c24'
            '02d71746be69d3689ddaaa4c3ef1ec8144e9d5e9f027b5a40c54aa98306777b2'
            '5d582f4d8fee9b2d826666928d3b21d8cff2a78646c0d90609402d31bde65b47'
            '8efc0233f4bcc274686f5ff332b460326073e8d16d3b11c8227c371590c945c1'
            'f5e76eeda7656fcb17906ddda537a20bdc30bdfe7238546142ba751cd6a09846'
            '6354a3dfbd773dc954b2c4688f53525fafa22ba8d34932a87855e72babac0dac'
            '20b24ae07f6d41e19765be9a9eef8c4078164d1e1fcea3261971f88ce9b40069'
            'af614dcce2d027a8b872068b3527a5557da491a4fdc6690c066f774df8c4f44f'
            '11733165a356e382004e392d0c9dc02cbec17154113056f76c767b96d7e7c107'
            '73dc75a07ddbcd3bfc2a64b639b7c847c7f34adcc3592cd2dcce50e65ff41235'
            'b33f4e587b60a3bda66e250eb81d5da3b9b1c533f5b4ba5c4e2cdd8e1d01755a'
            '2f751005043c336fcda10843d6d3566553260f2157d9f626b8060e08d102761e'
            '549bf48468b78bd93007d7e95c91456278a63ed72ad7414e957039a3577a3d73'
            '4396ab2b0d574a2a507df3351869286c6d2513c35a9ca39bf9d093334b62671e'
            '27eeefe1d39ad14b2735a07b505d6df9d990c6df53fd5127d13a31f4c54c597c'
            'ef87f46c91d56a36ddbfd7e5d158571eb1a20b7c56078bd74745212ecd0c5a32'
            '47b4acecd412fe1bdf01441d6b0eb9243bebd04ea13f5f699004f3bf09f04e03'
            '288180c40c0d44fb9c9048a873e8662e221f8d3c5952daef4a2220148b8dbe59'
            'ce578baa6ba8318db29afeda36638a34fb06a854de76d79aa8d5ed3e741cb1c0'
            '2eb47861c8580ce9f4bffb8a1fbc26f57d9ccb784e5e5de2a0439bdc1f3d8b65'
            '6f9ca7600994169905aaf01c027e2873224fb4981155132454663c64521f3a80'
            '51074907de6ddbab45f8006bbeba609504583ef765b99b75151b24807ad5a2bd'
            'e54ffbf51a9c5ab5c5f688935aa4d298c288667a7aa89bcb02397b1239328a6e'
            '8b4a5a6ab5508439cf5c55dd7eb377d918540c3210a7a25e83d0918d423ee8a0'
            'dfc2fc25e7ecb28ebcb54b72e28b13b5284c2c4252e5e2e125a801051b5b64ec'
            'd95583078a7e359a0825fc534b3fe7085a9b347bb3d3bb921a5d046b42e4b19f'
            '9e4793a4924a7ee2556ceca84c623cc4b69155c266e20f08857b28af88b436f7'
            'cc630255b316c2509607b6e345f3e6d12594e1713d807795dc8005871ba56ee4'
            '6ac638c2de6ad558dd4cf8d26498fe67f05b06e8111424766042443b26061459'
            '377bca4e1c281fcf9c9e7c2fe5fea627bf95f366ffa77b258bf2ee41c774f732'
            'a6734c9a5a2a9403741e811e8e357e874285fc015cc4babf9116728ae56de7ed'
            'f8ea546806c2506ccd28bc4803abbf60a73c4b3ea65ec58f5110a29c9b2d37b1'
            'f73a20e50a9533209f81fbe94cb417f47533014bc0ceaeaf9f4e45fab326c3e6'
            'bd245a87fc09d76ee1594e1f86576d7a653761ea7cf500301ee55552c6e58bf5'
            'bc392e8a5da7b05ffffd9b6a4b165996c4f13fa8a71be6c4a99824fa95ee9ec2'
            '720e5faec9b625cbe5501ed7a55155c58648eb3a8a39c003c83b6f61732d6b9c'
            'b74819a1d3ff28fa5e5359830e00d33138c8d11b8056e1ead5e1ececc69902a6'
            'c34828b2973c737581a1d58b3f33d896fd1e7153498cfbe3001cf3dde04c3bdf'
            'fcf5bce4c70863a11c8ce78cd06f1b0cc2da1cbc2098954a2becb9f56ce9a33e'
            '084e714c5d0c63a4e0cab40877a51f3e9e67f8b65d46ee9a2232144065a6b4e4'
            '70544b1bf873057af962f9ba79962d19259d2c764421a38fa5ffccbc0fc790dc'
            '02bd1f43d5624d95a9991579ddecb285d1efe23d9a118d4e15a10fef9689e828'
            'fc5510d113370fde5782c631177ead80f381a0631a70b4d90efa680b8f7bc061'
            'cdbb903aebdc347ce67b3173da79cde9bbae959ee942f198d9883a314d84a097'
            'c4573d5bc2a0030be78a0250b18e4d5bf753f8946be1376594cf749b11ef979e'
            'cb8714881c26f4969eaef5755d9e7f452375a21bbd697a6be056ea7dd76e5958'
            '4d0424b117467dd98045b4a6359f2af98751ca585fb5646b7ded1e67b6f124dd'
            '9a15f7c744afaa5cee717ccc08ffecd420fd3ef2f62fdaf4e525dc3a473d7e33'
            'ba3f9d7331a24278bf643a8a9374f6848da721a6714109f624e592a0c79f341c'
            '0bced37b077b0822c60a642daaa4eed3b6c241a957fce2b38219f60e4e099152'
            'f08c937dbe077c3cecdb0515a3a7787ebcfc4a50430f8bdad539403bb8b070aa'
            '0954e78562cca11ebfba286c0b2eb696bb177ea7d141df34263f2d3668b9acfb'
            'f154912fa547651d8042981e8bfb33b067cb505b3cbbdb10f8adf58805f49124'
            'b1e57a86f109554b07daaab09f0a146fbdfb4c71607208c073ce5e80e63722ad'
            '47ecb77c46ebe5a542e14ab9414f55a73a55878f53c34050a8e23b41f72a9193'
            'c51903d959759521a19bce995fa68e3cab5093108f03fa242058d5d212a3980a'
            '56c2af9b2f12f9ad0bda1ee4df3c7d90d73990c1823c780c244d6ed8f04261e8'
            '6068c90b273d1ab74143392b36100e1bdc03d7db9a61968aa0fbf01998517082'
            '4ec69c7de1d3f0395556fba8b3c9e6e6d76ae40561a2fd7239b7b1e26c786ae3'
            'ebe3e77107160ebc8515ada8756dbce9865cf27ae02d51a0559dcac9b5845f69'
            '14179075582a912905705f5e358797e8262420761b140a193f396041ac6756af'
            'c0b06e8a6b1abbe07be226a9150c58cb51a465ae7217dd2130f12f1149327d61'
            '76d0e55e076de4038204c705311c7cc3f73b40a057fb29c86f8c533299de1a22'
            'eeada1a602b945f0543db5416a68ab064c5eaf678f8a840b1ab277338e298a82'
            'ddeb1e70a0ffddff4c16aedd0955954486c1fb42a9df006eb2d72414c86ead58'
            '32c3290b8b1a83927225e2586eaa14a01e44107518600f427928c86fb645849c'
            '1b3a26436b0da0dbd8036cbd83a1047a40ab5130a375f6f3fa06edfc96e9b8d4'
            '423341b78d2d769e6197b0a8032bfd02b46d6da92ffe0a48d39d91f1aa1790f9'
            '926964a316d01d2411bd41ebb09e6a3d28b04f31eb95331a62c2240fe4b3b312'
            'd6b2735c0ab0c54e44973d3bc93fa5bd4d664ef21e6058fa6dcbf60fa1a7d3ff'
            '9d9b2cf051e2e28600d9cab8d5297832deb8871777cdfe29e5082dbd3e3271ea'
            '07c210d682299c66a2fc6f1e5087125803c4b4a451da1f852b9016857b4acff5'
            'b4a96f84105aec08174b084c77425f1ff7adb8623b04d6f971dd77a4bc28a10b'
            '14ba42437a444ee15fb1c9c3a318c275e23ade11f7739d946011716be74f5ea4'
            '8dbfee43802ebc39a2c0ffcb12657d55ab54c07ea5b17e69a5fbe435598e7b4f'
            '792ee1587677c9f30e9711f189edc06f564ce5042167ccb182c5750d46d6e7ef'
            '3b521d6a9709112361249a93339ecd77be1d53e775d15fb8a82165870c7f7309'
            'e57aada2c63c6fe6c6c6b4efbb0464b60151c8ba6e63fd4db9c48b02c767aceb'
            'e548a1869d8fca90d9f991c57100a5b0633bf7803fe3d092fe51ff42cf769549'
            '7c6d80b7fc003f070bcdbc6b4c485396b41fb2e87aca7b3626723a0f72d82b34'
            '01c2c286c26941711e06eb352257d8c762401d49336c575c52e11d4909d1357b'
            '6a9e2d60113bde44f4bb9cd68170857e2b00aba631e882662f7a5600a42cbbd7'
            'a21fd0d0f6e000a2a67cd32c508d431d15d47c99d5538ab27972ba76a94b89cf'
            'f6db3068e8259a68eb53cc4eb6190b9c2e3283d0317a8fafb4da60fdeec5bec1'
            '585c58b00d1eddb500fc8ffd4c3e370c4d827f96a5f36c1a32a591647942d404')

