pkgname=firefox-i18n
pkgver=38.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('f160f7f8e29cdede3aba46ed99d81ac6b12fd7ced751ccbbc408a3c577e269a1'
            '1171e97e31aa01063b9bc61d5c5d8954a73e76710a3cf78b266fc1746c061eaa'
            'b1dbfba79a3bb8591cc6f4a1cbfc1bdba82ad0b816b9e0a1cbc5f9475f59c06f'
            'ea0128ec6bbe6d4dd250117f7a76a4f3ef41c156b3a766c8ac5fe7e6cd3b5ed9'
            'b22f4fcb4e6400eba05fc81bae22269050a6b1794347ce42c7f2bd3753b6c8db'
            'cc859594d32d80c856f6e54408496e57fc7a9155c53e7ff423c548a30cc0c97f'
            '0e4ccc2aa9426034e654516c7a55c666710e4547d55f34875f4edf6a35a3e808'
            'a14183f60003aff647198918e8cee849f718ecf537b5c37e0db00c9893c1b70b'
            '2dce0d04f6e082c18f91bc53ec2b9b3bf6cc567581162c3993427242a3d441c6'
            '075bc5f5070caaafd26935d5260e372047c2e0ba66d9defa56c6caead1a5b1ae'
            'e9471773b2dd1c752f73f32389c5973b1d7d20b6756feb0ceb5eb8ec8d2a7bf4'
            '1de839d16f00af3a6b53a2fbd5b2769d6a91c9a850deca54f4cb9c8ecbb01f99'
            '7b48a6d1b02dfb14d07ec58ec7081f769692b8ddff6282f00167b5b2e70c34c7'
            '0accf8c90707062f450dcf07c073acdf06f8f503cf9409b35867c19947d311b3'
            'f14c9f65846d6a5f1877d4290c71f4589220248c9f95df186de2340ed01f7dd6'
            '8b7a709405246ed753d6301aa7690dab1d2b3976ebf622737890c5ac767967c4'
            '774f7dffe706d00b2c477bfcfdcb4aa77a9f35ee2cff368ccd2d8ce2c310995d'
            '31b5812cedde0a45e62455d1daf4dab4043ebebcb8320b0ce4c476388b933333'
            'f47e5a3cce3fd39cc8cf12351e0f4947a2d8fe843888cc08026b373c2463aa2d'
            '7959edb4df6d84735fe24f30dd2220e77f41c5c5f5dba026769c72d3c4698a53'
            'ce292c5cec07681db413ce66d5cd334d0747b8255ebe938c008047c34c574150'
            '34fff67739f10c5c4bbf08d07183344855b0a79d73f69609002098cc04fb0043'
            'cd39fb18a27af050370d41719b24aca075ee9b9e4611dd9d5f9a0f998cb0ffa0'
            '7a7194eca81009c36bbaf516dfae5386b9b182dbc20f659f16486f5f8077c2b9'
            '37bd16fa1b4f258a5ac806eeb7102a791719c1f6eeaa665c82a213b727fcb3c6'
            'bd8b70d3f2cfb41520b1ac5ea8d9d213fb6cbfecd6bb1d3894387dd9b3457114'
            'b2302bd1382ab69792be1cbbd73b4a2c1769aaca4e1b70eb2e90fdfcaaf4ee84'
            'f43fa5dcd8d5a14d926dedc0ebdcb3516596cc0be5952461300910d44ef8fa9b'
            '5707b2511c5a6892abe8b6084b9f1e0dd53b96279fea28fcdf8dd31743c4c7ea'
            '8807de03e31f47c05963f355c7aa5b7d762e45408c01dbff2a6a38ed07fc2e76'
            '8b9a7c476537e19012f65f29c8f339394d5d999e1711a6748a5006aa7a96cbc8'
            '928f3dae29ab8e427a97274608cfaac9c72d35fd94c02366fcc5b870f8b9c845'
            '0815ac3d25393408fdf99691095597dc865f15f16c5ce53f76e65955af784a3f'
            'bedca8931f8b6145649975af0c7413e46c2ab054fbef91953397365b3e3270ff'
            '0458f283bc40ca50e4df5ddf9d94dd5db99ea81923f19a6f88dba3557edc6eb8'
            '23efc9569bbca816f6add03423c04029ac73f1197426a23eaaaa432452c17574'
            'd57f642b5839b44c114d90e89b2f84912d02ad0986cacf31974392619e553986'
            '4b51c934020433fe087350f21549e15ab34aaa3b0780eed947254330af280ba4'
            '75a501ce0e3f5be95e4337ff9c70981914e27829f45c8a67233843dfe2ef441f'
            '89cf9f933400ab92e0f5b2c6c8388f550fd3dd9a5913724cdad24bf775eee037'
            '36fc3b6200fa461ba5770e22ec2caac82e02fcda62186775ea9a6990e2e5c74c'
            'c17d89ec28c3a8ef893f7755d752d42250ef927e60669f1092482e4d5ca04b91'
            'fe1412c751b9778af0ca350e5512633d03cead69f3d71b40a5ed5850c509a222'
            '9c6240a9ea530d6f42d5d3106e133fedf2b0bf1b1ba761c3a58112b3fdcd93ff'
            '0a2533b081628bb0487252eddefa5be52eaab4e3939ed8fd99706123f812cd00'
            '03d3cff6a3579adf771a06c8a7bb4685b34f32c49f40efcab8de0fbe97747c7c'
            '98f41ca38d35ed6baf47ed09fcab3fef3445d56919b463276129c2c224458b30'
            '6fe42cfdd99c52bf771dbcc43292e6168a58122ef2c80a5d82c35bc0d6509865'
            'af7e638882f9eb2f713f705e6ed0c428a1bb3a7a14d976ea4b6c013ffeedbd8e'
            'da9e251af5172ab835bcdf3632549a201b1f6a341cf38a70101baec0badf9605'
            'af121a50ed2c1a34fb7d6de44622b5bd2e2d9eb4a1d24a8bc61fafb7262e9a40'
            '974d7032272c4c8ca1f37f63f6e8cda795f90f87744dc461d384848a558d7967'
            'dadee134581beaeaea6f477f5a83fb66ed8c9c987254ce1a76b72853e601a035'
            '4d11221bec319f3f34f583441d37ca5a7a0d073551ef30d89f759e1f324a0f22'
            '70a0fbbddd270b5896ce3d9c501ebea142ea1cb8292d3ce4f56023fd96db2270'
            '57531b5c2fedd5d9e991c28dcdd36388ee1437c2de40b18d49b40884cf41e165'
            '6fb989d4050c0f1dd7161dd45a7a1b98ba92ab1f8550cfa7267d9aad7a998a82'
            'b51b09e64080427c70611a1811bc7759e2962a428725f564b1d2c2b9aa5cbad1'
            '262048e0483eb3e96136ccbd1c4c34b019949433499fba4c30999fee696e1bc0'
            '38ea99c24bf962f5573abdf006079d0240a20a6dae6af6a03991b420832f0138'
            'c0e9a7c54acdec2f50b2c7ecd75802f608e6cf941f07ecc2e5e1b4df9999506c'
            'addab887e092fd4df82d5b7458c00177ffab25283ecd9bd59c72fe2d50174e46'
            'c512c985abf445e515732fcd9b7e2866909649ace36fe16ffb4f104e8884254a'
            '13e6b87ea398e2e168bfbb6839d2ecb4f05014c4c533008d3a15fa68e7346362'
            'a2c91cf71985940332b7f75b34c420418e05d7e61ca06f1884da286026dbc482'
            '8078c6f21a6811ff39238636406bd2b0af27ec9fd665e30aa9e6197de180390d'
            '00041503160842cd3930918c7c586b5aee73142fdec3c48f870be7f0a2956f8d'
            '86c6e4f4bf9e1e3af08b48600791cc00fc7297f4eaa953ed5607ecf4b018a383'
            '13052795bb6d9528a4294acf35e5d5064f9592e4d599f30de2a6570b22c7daea'
            '66b704bb3deb2f2819345d85cb653c218b20c6fd62b7879710549bb41bbf1686'
            '26c2d92431bce4268ffb43746e93e27914161502767aa1d942ca9550ecaa1806'
            'ad852ff5923e93c16d5cc882701a20b5fbac895632750d046b47fd87ce086bbc'
            'd7804140f3b0d28d92eae59e2de7955c508dfaf1557a3a9311529db2af0e480a'
            '683c6e1f2329635af8d63a178f78f2d7c560a4d611408506680fca89e8e2834d'
            '4a73f3a5fb4b80672ac3b0fdf548abe789e6334967990cedd5b9ec547f93bc80'
            '3367a632a6af2630d7ee2ddee0f0bc2ff90c88f7d83163c6303519e259db5594'
            '22f05f7f4583e39c1e51d3737ca025751e69f40a44b3545efbf40656c3a9c5ea'
            'fc43dc7b8f14c28f29011a21c5dd39b71d662b19770a6ad06cddb67e0ebd19f7'
            '06f3f26e6bee0de761527da2152e817c5ae2c81adf7a605489610b0b059eea66'
            '9c27b7062c68676958cf2fcf381288205e8be349a5ba4ae245a20b09c2a05106'
            '20e13fb32c49628f1e0dcfc9ed9078610764362e046bdf718de9b6ec1bd3ff6e'
            '5ab4a2db9d8c7135ddeadd8b07f5717e201f4a861d8d28e8e317436bf5c1d62a'
            'd702655f236e359c384fd02863168817b2bc924793ac8afb5d0c8df0a4d535b7'
            'c09a8e2bbb063defee0e6c98b33122d6bb2f28e89aeeab1ae153d33b4cb7a88a'
            '89002db26b4511f10b39caa1b331f4dc4c69451af840de1ca30ed23a703c7cbb'
            '457fe13c9821d3618b3477a68c794cfdd23e80588021cfd07a650f6d92c48d4d'
            '8d65c0902158e4d59ac25a4a6713b61191278fd2fd74ab32c2475a941d1b8dbf')

