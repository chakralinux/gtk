pkgname=firefox-i18n
pkgver=36.0.1
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('c0c42b5958023ae07ca7c13b8c183071bb5759b7c116cf26fdf636381c937cfa'
            '87cc4f3771932c5d2b3145f13d109b871637f32fcb77d636c7d21d537d6a1c7d'
            '90b67b303a7f2cc6782d70bc163f519bb0a528411b06ac08016f75be0e4fbe0b'
            '37d2d069dab1a948dbbb84604faf876c8ee4676a3e9885a4ce39b3d6271826f4'
            '8dd00b697bc7123c2c2061d77b1a32132da53ff5366fb39e4ff3a0213125ec1f'
            '737062d9cc710b6e3241e859a76bd0501086287ddaba6f3e3460845f396363c4'
            '116ecca5dc19083e237cf2969fd062b003c03587ed5c7feae9bad8fbbf5abcc3'
            '51d25377bdae9ab7be8b2fa7de8f6543424cf81a6aed50bdbd6da6ffb0d55484'
            'dc11de2cfd4fe191453db49e08d5d151e587223c69f41a3bb2ca41f3c12b3e7a'
            '53b45a4dd0cbcf3729cb285f36d1d04f0eeef39c813ec1e60d9d1fb1826499b7'
            'ffdd4deb360cf95a623ed1c1582ffd54ab15f7d6fc454fa94420c5756cc7f370'
            '5f024e9d0e811a6ca0c67cb0ca0e20aa47f46bc124e8d7d5919416c3038eccbf'
            '0125c241cb71998100253dc7fb0a181425e916467d9fab773d1e0318fff17b05'
            '5bc4b4238bfc5051f6fef2c6b5e81da35f5e77feba74459c6a6990a7e17f90e9'
            '47b536c33f77d33d945c2809a566a6e52ed6ab0ebf6c7ea63fbbcc17a0226afd'
            '20b92fc2b50c5e0ba1aa22b1f057dfb81e66c319599238b78a744e283066aa52'
            '6b9c72dbf43e97179c8b0a1f60e29d596795b840b784bb87cab518c5ea44d90c'
            '85f003d1e5adf5a69f0174f3530b5d0b3417c250d250570a4664b1322f18691e'
            '6f2f6bc6738f58aa548070cedf0171c290ebfeb67bd6a18d6c2292cc68dad5c7'
            '5ceee6d3256f0d7fce8f6afb40927feaee2028a663edd07d0d418cca12cacca9'
            '84ca1b6a3cf3f5658f958b53e702de16e952b7f8ed3cd0266972255c678c7d89'
            '2bcbca7cdece82d0dbdf7b79f3017860ebb05301c7c88d94f91cca578e3896c7'
            '68606a7fe846dc0d3e7056bddf1772c33fe4b88feb72a7f9aef0eb770ca906b3'
            'dde1c01c813549e8ea360c4aaf39c276cabd60dede2ce093bc3813667a5e807e'
            '218c86b27f127293f9b453fec45243b05adfa9ac0ddc5f4d8f732332bb306fe0'
            '3c9d27f3ab572fa6e3007afcc53dc4aa1071f745425aef8e139167d6d06c9930'
            'd933460e40f5558386865c60f410d50befa6c72300e88929d79a0656854506b4'
            'a6c703a646646ed484c95e0d1ee4aa64fa03cb81b90abad9c80914117d2c2494'
            'e8db71ddf4d6bb54f70fe753eac987531b43df894aca18cfcea74bfc2eb17c42'
            '2ec02629356f902d6c0c20b9c89caa099bf025e8fb522221469abb1336854e46'
            '6784ba5a32bf8bf8f9d896c0d49d41763adcaeafbfc54a13626a774c4968d6bd'
            '3502cd17ba04a07b003a7ab9e9b2c87ec008187022b19bc0b1b713adb85de542'
            '39439589fbb091f97be49329ad56199860a0fe6cb00d571cc53e5a71171fb824'
            '19b539b2e9b383e673884ac0fef34d1d9f64e878fc06999e6b1c1395314f02dd'
            'ff8f9aed631ac5e76be6fc4a8dbee62519b08e1696ee4cfe6fdb25334403de48'
            '166ceb0c6cfb0baf72a02b977306bcde6010cfdd55349bc7c0b89d358b3004b0'
            'a7d3d302946596c71dafcc25f71b4fabf3f6822b760abd42a5b7b18c7e82f644'
            '62483323cb07147aebb60b8cad44114a4f13e306fa4aebffd627deb28eb50f92'
            'e18ea7f1225dbc96b42ff568d38a645af8c33aba5577d8ead79fb611b49a0743'
            'ab51f2b3e66daa6d1107638b240bc979b07c05d8bcd2c1a47a25abbc0ad5de79'
            '1a48928fd229c301414578301af99221e1201a0f71fd000aa6b4226285ffcea0'
            '1bc5894c60f795a02127b061194098a36acb907fc55d2bb0215cb2cf3db8fd59'
            'd86c02fba860990199ec8d8b56a7066759511bc6a9038db47fba98408fb014f9'
            'f3d784c59b758b536adcd0cac2417a5045bfbea9eadd3c0794d86c14410d3123'
            '4ed0363d52039fb4f9269fcb70b7f5f32f2a7992e3dbec87d87f6a9b327d7143'
            '5264775764fa8aa6bae03643a3cda8c1a71520d006f95cca6e969fce332c6f39'
            'cd6f80097662aef8df1c7707e0aa6ce1dd1169c16f2d2ece52220f174d8c5562'
            '237c8c446aa3f8de1d75b8862a5205f8d8dafe68667e6ac12e39f67dad7c69c7'
            '870cc47cf9261dfa72c422ff449633eae057e9c1b7c6b149b742b7063d0be7a6'
            '3290c156398575f3548f635289147580f58ecf2ca48385151043165fe303aa68'
            '4c936d4d050e8471c59b3536613518eb96205b27543a706164ea85656343b4a7'
            '73342d7ede8e46d984552e2695b8354d524a370fab7f314a489260dc61cd9816'
            '3bc5673c3eebfc47cefaf91ebf060b3e2665e201fc6eb651b2b72d5ac75992ff'
            '7915dd249f6cc3005e1da4212ead832f023e6d2b564b5bc6c4fa0971c0b12c7e'
            '95d5d388ea26541384ab1378352e0316566ad5ac0a594a19b13569dc76de2445'
            'fc2e229197d08a3a881fa95d720106aab3612fe0cb48ae847a075ce96bd72d10'
            'ae9bfaf32d4f26098507b28c2dfa82f77cdae6d49c3cdce7eaa5cd7d39cdfbf4'
            'b501792dda9d4cf1030e7303780c7f97275b1c2cfbe022842ba12bb258ae35d5'
            'e5fdebe9deb1e6b2004c7f24de22c7cf145e8ca5ba7b058a14feb0873623ca02'
            '12095385140bdba8122428cf38b270d958704520a21db24a1adcb663fb9e703e'
            '16c53911c0e45fd77c240b4fa6d919e4f5e47a50c1b3a7f86168ddcafb3dee77'
            '6dba1968228dbc3fbb1565e17bbfd3c5d5380dc8fea5b1721062f37686039852'
            '6e2e62c3522b6bab6dc0443d99e100ec63c02bb7f7a2754acf0a2535e9bfd870'
            '1f37e067c2982a712d771b669065bbfb694bdf786fd4b08c5124699c1c832a19'
            'e8ecf6ca289679c22b6bd61714119f20eddd8c9cc6e7bc59ea423ac4b8c045bc'
            'e3e447d85110e5247366931731cf94a18cd1ed5666e7a36a1beaa900b9de1325'
            'e57dbff1e4565b401420a3692493f16292f40f59635b1c7229c41098bdab8c71'
            'ca4ce98fb296436a799337af2dfad6599076a7571c7fd80f885f197a18408fba'
            '8d51ad7a3b3530b1ac3ae2268589c18b20041c49e0b741ab23fb706c50cd131c'
            '0f6aa113676c3c07a40befab3eee6a44f4188957d58553bc49043ec8645b5d1d'
            '6b57a785cf517150c3a339ebd82012067f2c6638d60f2940c313ade0e1e4f7f2'
            '8aa34963d5380df446a18c3e155a464761a07a16bda9802a775d86bab671c482'
            '677af6251ccbdd82989cd11616f30de81d92874f6bd57e26994728820d630b68'
            'd76bb50a268e8aa3996c37bf9a1caf16ae61106a7680e41f8a1a78a5bf8911c3'
            '6bbc55a096f002674a831e04ea9692264666f03d05c26d8499be20a9b3185f05'
            'f2ffe3684bbe5fe60fc358d82e0f66a8c9c0aa6153afc928fc0d2910319c5711'
            '6411aa3d528d40e2307e66b67cf2e5a4743b9d025b6c01350eede3c1615ee34f'
            '2bb0b34c50c4f10ec9f5e029dff959f9863a6a09af3a5db4a419fb5e2a352b06'
            '10582e2014b4121571572fee2af8a69cfb33aac71d845e7c6a7aaac6163eef48'
            'dfe9e480fab08d1a261ce639bc35852b6f956c65f3c1d6fe15e6035ec2a64959'
            '163f6a77ce0c57fc8b2c0e50f1590247b43aeccaf89c33a4bdd8f5b5b2548f45'
            'edea650c24d85064422529a2682cce983701199ff507633f55acc93029f9f26f'
            '9b2b1079c6158a27c86f745a3f276f09f5916f1a1d813d61d44eb2e02a4ad068'
            'b2d6b5bc2787d8ca5f2f96dfd7d9ea80ddc5ef666a686e5a87014c62e9367487'
            'd026ddb7177aa72d6adf6d301d2e079217b6a347a88b8fd168ee656bbfa64cd6'
            '798929865c00aea4c0be6f63a6ec42c4f6f1bcf157ca504f0b29f0f17f355176'
            '0c48a0f53f69106c0e24141793604f7bcaa7fecc05b2c33f093e84abf1312574')

