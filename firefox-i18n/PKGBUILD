pkgname=firefox-i18n
pkgver=37.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('x86_64')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox-kde=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Dolnoserbski"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Bahasa Melayu"'
  'nb-NO  "Norwegian (Bokmç–‡l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhay"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=('firefox-i18n')
source=()
_url=ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-x86_64/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

package_firefox-i18n() {
  pkgdesc="Transition package to split build"
  depends=("firefox-kde=${pkgver}" "firefox-langpack=${pkgver}")
}

_package() {
  pkgdesc="$2 language pack for Firefox"
  provides=("firefox-langpack=${pkgver}")
  conflicts=("firefox-i18n<31.0")
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}
sha256sums=('231c282ac594901c3fea52be2c043e46cae8e775a8adcb3810d0a99f1904a641'
            '91eeee20d68807898b4b79351832e4e8e102550809e62081559dda8c5db0a1ac'
            '6e5c7759df1b301709a983d494b7e0eda479fd3af5c4962a9a911a0c5253d07f'
            '5ff8db21c4693a90f14a54ed04176a7502f9fb60095bb9d07608cdc5f6f73f13'
            'ccdf61aac4eb2a219a2450eaca2adc3be1dfaf4355e190fb94f6b3080d914f68'
            '75af24b7082c63d1305081dbf2fbd34ccf0adb92f63c4624167025b0c953bb87'
            '125bcbea0ee8a4e527a82c6bd009e6a891858d3cb4933ef9619bdc4d48f12b97'
            '0c0ec51896d97b6d7d1f7a163ddefad2cb09404494309ec9c9a691e41810fcc1'
            'fd8a5488337dc583ccd8fbe3290994b91c76269b8bb946c161eba62373f116c1'
            'eb565041d4a8e72f7895dfdbf83b74044e1cc8a1ec41342b2fffe47cd637a2b0'
            'b751b122f71decc735d5110cceda09844449ae97882e991d282d135e03380fea'
            '050055cc24ba5f20f36dfb4040f57c8384617f0f66626efde852cbc6ee0eca4c'
            '3690b6982114702cb4691a21975cd56993c4b60ef340e1c4a3ea480d15435d37'
            '3b5dfada444293d266643eb0f56600bacaeee530a4e362d6367b392ffa1a402f'
            'f7b11bdaf0e148cadb2c52d87489aa14cb085daae6b8d43c19373032ce78f809'
            'db80742b6adde4c3766fa9c4cc2846a19b127ef9c4318e4366bcfd34ac3faabf'
            'bfe3f9804abd3990667795579646348affa5740744651230d7909829e2557b7a'
            'c659c868ff018aa9075b077ec482e030bd488d0dab9d3743c66fc1aef393c4d3'
            '57cecc21a8a19a8d66d14228c8909bae35a277b9d0c5556a739cdcc9593a3b25'
            'b3c5f5322c78c0d772454d43b5cee504f4bd23fbb29ba7190f1ce3549ae11588'
            '73dcac25207a377263e1dd9020f097c90831a59e1e68dc158c62c896057cdcce'
            'd5903caa4e42a3200b5233438e3062a9fc303ac9a119590f329e3a3cd182244a'
            '465378f75f0d4292a219da79e830717f3468522486701b38629b43b1b8fbe1c9'
            'c5a371caf9c6c97dbefaea53dc3d8d89163d9ac54ba9a2025290c660121ba8e5'
            '459150f24117fe5342132dce2f8d97c6f9b666e54d0e1057323cb02ae04ec45e'
            '03d80d7eb1a6c379ad21247d212e90f80d691617becc8227f2ab91d256b99b20'
            '51f5262e46f187c47b6568c395e7a2362d78b81501a8ded6ac6da49d63faa7b9'
            'a9b17e6a00ce0bfe2d5c8ebbee8134b16a7c512cde2d792bb58289deed643c76'
            '546f648ac584a46713e2b0c3c094a79fbf575e41da5016ffaf4dc622d7a4f078'
            '2ae2bdf3143149641a8600004216f95b84bbdb4fba7bdf23a5eb9e4b85415393'
            '5784fbd02b98be4c1521a97cf8672d3f293f99749d0afde93a7d306d15516919'
            '30d36615af1dbd18ff44836f799938af3124de308cb7a5972d1f4a4759951641'
            '2a2103c3b7469b1b4f58010562ee9fe7c395aeb5e3ed530ccf5e7415c0d1de47'
            '8220176450be3e5fe54765bac62a21b94cd550141ab42a632ed2d1c1df84c035'
            '5fb04a964d4dcb491c3487d1ddc20c2167e8c69dcc668f2bf97f7004534fdc2b'
            '03d82b3dbaf874c3f61804b7b7c73908b2c78d5f0d96d5ac277880ce5c5b15ee'
            '6f824ec70bb8cfecb2c6d20aaf220e2602568c72ae835d0ff04138936c370375'
            'e14a505a28d5bb4371ad46562f61110da1889c5ff20ff0881ca4e90b34325b3e'
            '50a441a1f4d059c966e29187c3c695ef5739c4681922fdc66581bcef891c002c'
            '2dbf58d6e13b1d635233166ccb1e5c047499b1831ca9d80855c5a994a8433985'
            '5a9746175ce5065c4ae81fe5d34ec6e34207417271a5ac0c76a7b081e41c2bc9'
            'adf11eee278729536cf54b5a28a3a220e9559454abe98f592b128e61ba8669f4'
            'c3bbfe9e831eb26294004c00521a387cbd3a2871f5cca1cfb45c71e205a7aed3'
            'd419d77e1e3dba6c8521f79ca7ae00fd4fd02686433181bd70c99a708b6d04a6'
            '84193d7ca2c6a87b0699fd1b67981ab1bc3e7986ca3f82e96130623852d20686'
            '2c6a9f60f2d9a41c5e480830b061147c59d3232130342ab70d12ea02cbfe88f5'
            'a533d8a20f0a33b8e5066bd61f8ef829803172982b9fc392741c40d239715bdd'
            'b3b1b84325916ea03e13e430f4d70a68e3edff53a3f9e8eb08b83b6823bfb84b'
            'b03d26cf8b37f7e4d5ccd72fb8a9eb432b51df57c77584a13ff302c49cdf1ca9'
            '232115aeca3d5b7449b052c06b9ff393605b5418c6063897c1a0c918a17c64e3'
            'a25c2f7b39e605474513730071bed3b57a7659847ee023d25217e22c8ea819ac'
            '1650b70aa56ae40bb0494adffcdcd101df6373e0e6835946274cf73ca95d4c42'
            'e1f698cacb6f80d9dc4a2cdd15bf55dde73fd764a8dc7aa5a37c366851222441'
            'd6fd07b6167c8b6787760614c12a37bf19840b08463819bb4f2c0672a4e75e1a'
            '30c741b7eac5611fbfc3f23bc80fd326495e18630491ac6c654e6d43f8f1b621'
            '56d8138387dd3886be1b4c13df9552431bd824fea9ffed12907cefe33a25a96f'
            '37a213a8f494ab7e6e09e62b6cd566cba626f1dcb2f70c377f3de2dd937aa470'
            '84f773560578dc4148c49870f7b9f0cc088af99f97f955cc2054dc16f9f756e9'
            '8fee1dc296057a341fd5cdea21a3d9b7f954623a43c496fbe219939aeb401f58'
            '3125e74c8200c1d6c6a35054aebc092cc754aafe9046edb9d87ad1ccb9677dff'
            'e2bcfe116499b9d3d1ea55c23c873c62fabc86ca211a51d40e41839ad7ce70de'
            '7c829d03c7b6e327b59a51b196878dbbfd19b60d20b8a163a8f9cff9dfca02df'
            'b6f6bae7c33a618cb32673f6c77bddaf746c24c5313b3159bd295fec0279684c'
            '0a6a3a49cd11e46412ef277a682e20d6ca45e0db33d36e4f0bb301b5166acbc5'
            '66d7243d8e3effbbdf56fdfdcaac03527f50b70b60ccd0d736acb633809b7395'
            'c5e27f450691d7c20b3df2e8f08ff33b177329ddfa94cc59f6ead83e683fdc65'
            'faf2d515aa5a46d41a46e3e766a6d350f2408120fda17a537576ba0299829541'
            '6fb6b44c3e5e5ed4ad226a450bc66421f6babdfb1ebee60b84ccc8572cbc9a4f'
            '9d0d73f175788bac086bb06a7eb0997a3285bc2918ed798d2e96cd97b26e4880'
            '0fb63cac9d277c517172f0b977703db488319a2f5e84eeb5401268a52a1da620'
            'e7c1a714eafd856fbe08a869d383e8d7d007c9dbd97396b4ff2cae9f2580d373'
            'aadbe6ed2eba9e46c61c558cc479e8e786d814195a338608e9087b9f859ff774'
            '6979474d40940e5643443d2a109173856896c349ad581e34b8b859988f82906d'
            '6eb885988552463e63f06093762f47298e451642bd9912d28e29ad973830b26f'
            '1b00b35287f0820c66d4c6075a1f64fd5af41e27e8952f11c795f999280b96aa'
            '4bf6264caad19193cae36ebc9c56f94f026fb8cda4837d3c9e01d67481b0cc63'
            '42c466d6596da85463eff61924afb93fe2d95a625e325cad6ab61071cf73fa35'
            '62efc49186550bb0d1408298480d9d0d19ea01440b881ac52c5f5d701bf25e5e'
            '1dde9f202aa30af834c562d61a7d6ba66223db191ee92bf2dc092f671e63752f'
            '68f904e97d2a01e8a75526c4c9f99fe7ad2da626568357d2c56ce72b36f3db46'
            '8738f28817e393adcd70dc98ce399cfe16c198b9ec18bfed37af12c53c068b74'
            '73bf4ebe870862a69430d06bad8222102230ba492d4e5a7ac2a55cee45143046'
            '0e7cd5b842d2cc67ab6b5a934e1b3c06c847376f049c16857d84bd0d1841dd3a'
            '8d940fbac8adc3c9fdea017afd50937017fe334f8fcb5e77ad79a2e99fbb92f6'
            '1c90491fc429712b2e8f94a8073eb89faa5db2c0f05f3bd8c5b69d638e9a8219'
            '0ca03eeb3d52452a92876706fc3afe079a37854220a099baea5836736357d248'
            'c4798595be595f5b747843db80452f48619d315897c975918674f9cfae9dd17c')

